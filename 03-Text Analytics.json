{"paragraphs":[{"text":"%md\n## Text Analytics\n#### In which we analyze the Mood of the nation from inferences on SOTU by the POTUS\n####   (State Of The Union addresses by the President Of The US)\n \n#####Goal is to find interesting words in the speeches that reflect the times.\n \n#####Am sure Lincoln didn't worry about WMDs and Iraq; neither did George Washington about inflation, Wall Street and Jobs.","dateUpdated":"Mar 28, 2016 12:22:27 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612411_1173105812","id":"20160328-003652_1645428015","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Text Analytics</h2>\n<h4>In which we analyze the Mood of the nation from inferences on SOTU by the POTUS</h4>\n<h4>(State Of The Union addresses by the President Of The US)</h4>\n<h5>Goal is to find interesting words in the speeches that reflect the times.</h5>\n<h5>Am sure Lincoln didn't worry about WMDs and Iraq; neither did George Washington about inflation, Wall Street and Jobs.</h5>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3343","dateFinished":"Mar 28, 2016 12:22:27 PM","dateStarted":"Mar 28, 2016 12:22:27 PM"},{"text":"%pyspark\nfrom pyspark.context import SparkContext\nprint \"Running Spark Version %s\" % (sc.version)","dateUpdated":"Mar 28, 2016 12:22:27 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612411_1173105812","id":"20160328-003652_1561725686","result":{"code":"SUCCESS","type":"TEXT","msg":"Running Spark Version 1.6.0\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3344","dateFinished":"Mar 28, 2016 12:22:29 PM","dateStarted":"Mar 28, 2016 12:22:27 PM"},{"text":"%pyspark\nfrom pyspark.conf import SparkConf\nconf = SparkConf()\nprint conf.toDebugString()","dateUpdated":"Mar 28, 2016 12:22:27 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612412_1171182068","id":"20160328-003652_1378470968","result":{"code":"SUCCESS","type":"TEXT","msg":"\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3345","dateFinished":"Mar 28, 2016 12:22:29 PM","dateStarted":"Mar 28, 2016 12:22:28 PM"},{"text":"%md\n#### MapReduce in one line !\n#### 1. Split lines into words on space\n#### 2. Create key-value pair with key=word, value = 1\n#### 3. Sum value for each word (er ... key)\n#### 4. Then we get key-value RDD with key=word and value = number of times the word occured in a document","dateUpdated":"Mar 28, 2016 12:22:27 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612412_1171182068","id":"20160328-003652_907975340","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>MapReduce in one line !</h4>\n<h4>1. Split lines into words on space</h4>\n<h4>2. Create key-value pair with key=word, value = 1</h4>\n<h4>3. Sum value for each word (er &hellip; key)</h4>\n<h4>4. Then we get key-value RDD with key=word and value = number of times the word occured in a document</h4>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3346","dateFinished":"Mar 28, 2016 12:22:28 PM","dateStarted":"Mar 28, 2016 12:22:28 PM"},{"text":"%pyspark\n# imports\nfrom operator import add","dateUpdated":"Mar 28, 2016 12:22:28 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612413_1170797319","id":"20160328-003652_322743798","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3347","dateFinished":"Mar 28, 2016 12:22:30 PM","dateStarted":"Mar 28, 2016 12:22:29 PM"},{"text":"%md ###Let us read data, strip the unwanted characters and convert all words to lowercase","dateUpdated":"Mar 28, 2016 12:22:28 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612414_1171951565","id":"20160328-003652_1958804311","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Let us read data, strip the unwanted characters and convert all words to lowercase</h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3348","dateFinished":"Mar 28, 2016 12:22:28 PM","dateStarted":"Mar 28, 2016 12:22:28 PM"},{"text":"%pyspark\nlines = sc.textFile(\"data/sotu/2009-2014-BO.txt\")\nword_count_bo = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.'), 1)).\\\n    reduceByKey(add)\nprint word_count_bo.count()\n# 6658 without lower, 6299 with lower, rstrip,lstrip 4835\n","dateUpdated":"Mar 28, 2016 12:22:28 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612414_1171951565","id":"20160328-003652_699746467","result":{"code":"SUCCESS","type":"TEXT","msg":"4835\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:30 PM","dateFinished":"Mar 28, 2016 12:22:40 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3349"},{"text":"%pyspark\nfrom operator import add\ndef getWordCount(file) :\n    lines = sc.textFile(file)\n    word_count = lines.flatMap(lambda x: x.split(' ')).\\\n        map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.').replace(u\"\\u2019\", \"'\"), 1)).\\\n        reduceByKey(add)\n    return(word_count)","dateUpdated":"Mar 28, 2016 12:22:28 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612415_1171566816","id":"20160328-003652_1018419897","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3350","dateFinished":"Mar 28, 2016 12:22:40 PM","dateStarted":"Mar 28, 2016 12:22:30 PM"},{"text":"%md\n### Scala equivalent\n```\ndef getWordCount(sc:SparkContext, file:String) = {\n      val lines = sc.textFile(file)\n      val word_count = lines.flatMap(x => x.split(' ')).\n      map(x => (x.toLowerCase().trim().stripSuffix(\",\").stripSuffix(\".\").replace(\"\\u2019\", \"'\"), 1)).\n      reduceByKey((a, b) => a + b)\n      //println(word_count.count())\n      word_count\n    }\n```","dateUpdated":"Mar 28, 2016 12:22:28 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150759126_-1713113515","id":"20160328-003919_1571839067","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Scala equivalent</h3>\n<pre><code>def getWordCount(sc:SparkContext, file:String) = {\n      val lines = sc.textFile(file)\n      val word_count = lines.flatMap(x =&gt; x.split(' ')).\n      map(x =&gt; (x.toLowerCase().trim().stripSuffix(\",\").stripSuffix(\".\").replace(\"\\u2019\", \"'\"), 1)).\n      reduceByKey((a, b) =&gt; a + b)\n      //println(word_count.count())\n      word_count\n    }\n</code></pre>\n"},"dateCreated":"Mar 28, 2016 12:39:19 AM","dateStarted":"Mar 28, 2016 12:22:29 PM","dateFinished":"Mar 28, 2016 12:22:29 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3351"},{"text":"%pyspark\nword_count_bo_2015 = getWordCount(\"data/sotu/2009-2015-BO.txt\")\nprint word_count_bo_2015.count()","dateUpdated":"Mar 28, 2016 12:22:29 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612415_1171566816","id":"20160328-003652_1138542289","result":{"code":"SUCCESS","type":"TEXT","msg":"5275\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3352","dateFinished":"Mar 28, 2016 12:22:40 PM","dateStarted":"Mar 28, 2016 12:22:40 PM"},{"text":"%pyspark\nword_count_bo_2016 = getWordCount(\"data/sotu/2016-BO.txt\")\nprint word_count_bo_2016.count()","dateUpdated":"Mar 28, 2016 12:22:29 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612416_1157331107","id":"20160328-003652_864399863","result":{"code":"SUCCESS","type":"TEXT","msg":"1589\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:40 PM","dateFinished":"Mar 28, 2016 12:22:40 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3353"},{"text":"%pyspark\nword_count_gwb = getWordCount(\"data/sotu/2001-2008-GWB.txt\")\nprint word_count_gwb.count()","dateUpdated":"Mar 28, 2016 12:22:29 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612416_1157331107","id":"20160328-003652_241625486","result":{"code":"SUCCESS","type":"TEXT","msg":"4957\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:41 PM","dateFinished":"Mar 28, 2016 12:22:41 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3354"},{"text":"%pyspark\nword_count_wjc = getWordCount(\"data/sotu/1994-2000-WJC.txt\")\nprint \"WJC = %d\" %(word_count_wjc.count())\n#\nword_count_jfk = getWordCount(\"data/sotu/1961-1963-JFK.txt\")\nprint \"JFK = %d\" %(word_count_jfk.count())\n#\nword_count_fdr = getWordCount(\"data/sotu/1934-1945-FDR.txt\")\nprint \"FDR = %d\" %(word_count_fdr.count())\n#\nword_count_al = getWordCount(\"data/sotu/1861-1864-AL.txt\")\nprint \"AL  = %d\" %(word_count_al.count())\n#\nword_count_gw = getWordCount(\"data/sotu/1790-1796-GW.txt\")\nprint \"GW  = %d\" %(word_count_gw.count())","dateUpdated":"Mar 28, 2016 12:22:30 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612416_1157331107","id":"20160328-003652_107966725","result":{"code":"SUCCESS","type":"TEXT","msg":"WJC = 5476\nJFK = 3656\nFDR = 5933\nAL  = 4156\nGW  = 2951\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:41 PM","dateFinished":"Mar 28, 2016 12:22:43 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3355"},{"text":"%pyspark\nBO_df = word_count_bo.sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"])\nBO_df.show(5)\nBO_df.registerTempTable(\"BO\")","dateUpdated":"Mar 28, 2016 12:22:30 PM","config":{"enabled":true,"graph":{"mode":"table","height":160,"optionOpen":false,"keys":[{"name":"(u'the', 1812)","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"(u'the', 1812)","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612416_1157331107","id":"20160328-003652_2120549007","result":{"code":"SUCCESS","type":"TEXT","msg":"+----+-----+\n|word|count|\n+----+-----+\n| the| 1812|\n| and| 1375|\n|  to| 1351|\n|  of| 1013|\n|   a|  802|\n+----+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:41 PM","dateFinished":"Mar 28, 2016 12:22:43 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3356"},{"text":"%sql\nSELECT * FROM BO LIMIT 15","dateUpdated":"Mar 28, 2016 12:22:30 PM","config":{"enabled":true,"graph":{"mode":"multiBarChart","height":290,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612417_1156946358","id":"20160328-003652_428555037","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\nthe\t1812\nand\t1375\nto\t1351\nof\t1013\na\t802\nthat\t778\nwe\t719\nour\t698\nin\t637\n\t585\nfor\t411\nis\t370\nwill\t355\nthis\t332\ni\t331\n","comment":"","msgTable":[[{"key":"count","value":"the"},{"key":"count","value":"1812"}],[{"value":"and"},{"value":"1375"}],[{"value":"to"},{"value":"1351"}],[{"value":"of"},{"value":"1013"}],[{"value":"a"},{"value":"802"}],[{"value":"that"},{"value":"778"}],[{"value":"we"},{"value":"719"}],[{"value":"our"},{"value":"698"}],[{"value":"in"},{"value":"637"}],[{"value":""},{"value":"585"}],[{"value":"for"},{"value":"411"}],[{"value":"is"},{"value":"370"}],[{"value":"will"},{"value":"355"}],[{"value":"this"},{"value":"332"}],[{"value":"i"},{"value":"331"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["the","1812"],["and","1375"],["to","1351"],["of","1013"],["a","802"],["that","778"],["we","719"],["our","698"],["in","637"],["","585"],["for","411"],["is","370"],["will","355"],["this","332"],["i","331"]]},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:43 PM","dateFinished":"Mar 28, 2016 12:22:47 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3357"},{"text":"%md ### Yikes, we need to filter out the common words","dateUpdated":"Mar 28, 2016 12:22:31 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612417_1156946358","id":"20160328-003652_64354821","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Yikes, we need to filter out the common words</h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:31 PM","dateFinished":"Mar 28, 2016 12:22:31 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3358"},{"text":"%pyspark\ncommon_words = [\"\",\"us\",\"has\",\"all\", \"they\", \"from\", \"who\",\"what\",\"on\",\"by\",\"more\",\"as\",\"not\",\"their\",\"can\",\n                             \"new\",\"it\",\"but\",\"be\",\"are\",\"--\",\"i\",\"have\",\"this\",\"will\",\"for\",\"with\",\"is\",\"that\",\"in\",\n                             \"our\",\"we\",\"a\",\"of\",\"to\",\"and\",\"the\",\"that's\",\"or\",\"make\",\"do\",\"you\",\"at\",\"it\\'s\",\"than\",\n                             \"if\",\"know\",\"last\",\"about\",\"no\",\"just\",\"now\",\"an\",\"because\",\"<p>we\",\"why\",\"we\\'ll\",\"how\",\n                             \"two\",\"also\",\"every\",\"come\",\"we've\",\"year\",\"over\",\"get\",\"take\",\"one\",\"them\",\"we\\'re\",\"need\",\n                             \"want\",\"when\",\"like\",\"most\",\"-\",\"been\",\"first\",\"where\",\"so\",\"these\",\"they\\'re\",\"good\",\"would\",\n                             \"there\",\"should\",\"-->\",\"<!--\",\"up\",\"i\\'m\",\"his\",\"their\",\"which\",\"may\",\"were\",\"such\",\"some\",\n                             \"those\",\"was\",\"here\",\"she\",\"he\",\"its\",\"her\",\"his\",\"don\\'t\",\"i\\'ve\",\"what\\'s\",\"didn\\'t\",\n                             \"shouldn\\'t\",\"(applause.)\",\"let\\'s\",\"doesn\\'t\",\"(laughter.)\",\"any\",\"other\",\"america\",\"american\",\"americans\",\"must\"]\n# This is my list. Would be useful for other projects as well. You can add your own","dateUpdated":"Mar 28, 2016 12:22:31 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612417_1156946358","id":"20160328-003652_550848218","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:43 PM","dateFinished":"Mar 28, 2016 12:22:43 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3359"},{"text":"%pyspark\nword_count_bo_clean = word_count_bo.filter(lambda x: x[0] not in common_words)\nprint word_count_bo_clean.count()\nbo_df = word_count_bo_clean.toDF([\"word\",\"count\"])\nbo_df.sort(\"count\",ascending=False).show(10)","dateUpdated":"Mar 28, 2016 12:22:31 PM","config":{"enabled":true,"graph":{"mode":"table","height":280,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612417_1156946358","id":"20160328-003652_303997709","result":{"code":"SUCCESS","type":"TEXT","msg":"4722\n+--------+-----+\n|    word|count|\n+--------+-----+\n|    jobs|  148|\n|  people|  144|\n|   years|  116|\n|    work|  108|\n|    time|   89|\n|  energy|   87|\n| tonight|   84|\n|congress|   83|\n| country|   82|\n|    help|   81|\n+--------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:44 PM","dateFinished":"Mar 28, 2016 12:22:45 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3360"},{"text":"%pyspark\nword_count_bo_2015_clean = word_count_bo_2015.filter(lambda x: x[0] not in common_words)\nword_count_bo_2016_clean = word_count_bo_2016.filter(lambda x: x[0] not in common_words)\n#\nword_count_gwb_clean = word_count_gwb.filter(lambda x: x[0] not in common_words)\nword_count_gwb_clean.count()\n#\nword_count_wjc_clean = word_count_wjc.filter(lambda x: x[0] not in common_words)\nprint \"*** WJC = %d\" %(word_count_wjc_clean.count())\n#\nword_count_jfk_clean = word_count_jfk.filter(lambda x: x[0] not in common_words)\nprint \"*** JFK = %d\" %(word_count_jfk_clean.count())\n#\nword_count_fdr_clean = word_count_fdr.filter(lambda x: x[0] not in common_words)\nprint \"*** FDR = %d\" %(word_count_fdr_clean.count())\n#\nword_count_al_clean = word_count_al.filter(lambda x: x[0] not in common_words)\nprint \"*** AL = %d\" %(word_count_al_clean.count())\n#\nword_count_gw_clean = word_count_gw.filter(lambda x: x[0] not in common_words)\nprint \"*** GW = %d\" %(word_count_gw_clean.count())","dateUpdated":"Mar 28, 2016 12:22:31 PM","config":{"enabled":true,"graph":{"mode":"table","height":84,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612417_1156946358","id":"20160328-003652_425898950","result":{"code":"SUCCESS","type":"TEXT","msg":"*** WJC = 5365\n*** JFK = 3560\n*** FDR = 5834\n*** AL = 4059\n*** GW = 2862\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:45 PM","dateFinished":"Mar 28, 2016 12:22:46 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3361"},{"text":"%pyspark\ngwb_df = word_count_gwb_clean.toDF([\"word\",\"count\"])\ngwb_df.sort(\"count\",ascending=False).show(15)","dateUpdated":"Mar 28, 2016 12:22:32 PM","config":{"enabled":true,"graph":{"mode":"table","height":345,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":6},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612418_1158100605","id":"20160328-003652_520657199","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------+-----+\n|      word|count|\n+----------+-----+\n|    people|  158|\n|     world|  131|\n|   country|  108|\n|  congress|   99|\n|  security|   98|\n|      help|   90|\n|    nation|   88|\n|terrorists|   83|\n|      iraq|   80|\n|   freedom|   79|\n|   tonight|   76|\n|government|   73|\n|   economy|   70|\n|     years|   69|\n|    health|   68|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:45 PM","dateFinished":"Mar 28, 2016 12:22:47 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3362"},{"text":"%pyspark\nal_df = word_count_al_clean.toDF([\"word\",\"count\"])\nal_df.sort(\"count\",ascending=False).show(15)","dateUpdated":"Mar 28, 2016 12:22:32 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":6},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612418_1158100605","id":"20160328-003652_1837165715","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------+-----+\n|      word|count|\n+----------+-----+\n|    states|  148|\n|      upon|   84|\n|    united|   81|\n|  congress|   77|\n|government|   73|\n|    people|   70|\n|       war|   64|\n|   country|   62|\n|     great|   61|\n|     shall|   53|\n|     union|   53|\n|      time|   51|\n|     under|   50|\n|  national|   49|\n|    public|   48|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:47 PM","dateFinished":"Mar 28, 2016 12:22:47 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3363"},{"text":"%pyspark\nwjc_df = word_count_wjc_clean.toDF([\"word\",\"count\"])\nwjc_df.sort(\"count\",ascending=False).show(15)","dateUpdated":"Mar 28, 2016 12:22:32 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612418_1158100605","id":"20160328-003652_724295439","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------+-----+\n|    word|count|\n+--------+-----+\n|  people|  266|\n|    work|  194|\n|   years|  176|\n|children|  153|\n|congress|  147|\n|    help|  117|\n|    care|  116|\n|   world|  108|\n|  health|  102|\n| tonight|   98|\n| support|   93|\n|     ask|   92|\n|    time|   91|\n|      my|   91|\n| century|   89|\n+--------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3364","dateFinished":"Mar 28, 2016 12:22:47 PM","dateStarted":"Mar 28, 2016 12:22:47 PM"},{"text":"%pyspark\nfdr_df = word_count_fdr_clean.toDF([\"word\",\"count\"])\nfdr_df.sort(\"count\",ascending=False).show(15)","dateUpdated":"Mar 28, 2016 12:22:32 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":6},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612418_1158100605","id":"20160328-003652_1296132077","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------+-----+\n|      word|count|\n+----------+-----+\n|       war|  238|\n|     world|  167|\n|government|  154|\n|    people|  141|\n|  national|  130|\n|    nation|  122|\n|   nations|  111|\n|     peace|  111|\n|    united|  106|\n|  congress|  105|\n|      many|   94|\n|      time|   91|\n|     great|   91|\n|       men|   87|\n|     shall|   86|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3365","dateFinished":"Mar 28, 2016 12:22:48 PM","dateStarted":"Mar 28, 2016 12:22:48 PM"},{"text":"%pyspark\ngw_df = word_count_gw_clean.toDF([\"word\",\"count\"])\ngw_df.sort(\"count\",ascending=False).show(15)","dateUpdated":"Mar 28, 2016 12:22:33 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":6},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612418_1158100605","id":"20160328-003652_17702971","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------+-----+\n|      word|count|\n+----------+-----+\n|    states|   91|\n|    united|   86|\n|    public|   54|\n|government|   47|\n|      your|   47|\n|      made|   39|\n|      upon|   38|\n|        my|   37|\n|  citizens|   33|\n|     state|   32|\n|   country|   31|\n|     peace|   30|\n|     shall|   30|\n|   present|   28|\n|  congress|   27|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3366","dateFinished":"Mar 28, 2016 12:22:48 PM","dateStarted":"Mar 28, 2016 12:22:48 PM"},{"text":"%md\n### Has Barack Obama changed in 2015 ?\n### As reflected in the SOTU 2009-2015 vs SOTU 2009-2014 ?","dateUpdated":"Mar 28, 2016 12:22:33 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612418_1158100605","id":"20160328-003652_1181090311","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Has Barack Obama changed in 2015 ?</h3>\n<h3>As reflected in the SOTU 2009-2015 vs SOTU 2009-2014 ?</h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3367","dateFinished":"Mar 28, 2016 12:22:33 PM","dateStarted":"Mar 28, 2016 12:22:33 PM"},{"text":"%pyspark\nword_count_bo_2015_clean.subtractByKey(word_count_bo_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:33 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612418_1158100605","id":"20160328-003652_1393507756","result":{"code":"SUCCESS","type":"TEXT","msg":"+------------+-----+\n|        word|count|\n+------------+-----+\n|   childcare|    8|\n|     rebekah|    7|\n|   economics|    5|\n|    believed|    4|\n|        cuba|    4|\n|  (applause)|    3|\n|       fears|    3|\n|         ben|    3|\n|twenty-first|    3|\n|  aggression|    2|\n|       ben's|    2|\n|     warmest|    2|\n|     times.‚Äù|    2|\n|      keeper|    2|\n|        alan|    2|\n+------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3368","dateFinished":"Mar 28, 2016 12:22:50 PM","dateStarted":"Mar 28, 2016 12:22:49 PM"},{"text":"%md\n### What about 2016 ?","dateUpdated":"Mar 28, 2016 12:22:33 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612418_1158100605","id":"20160328-003652_228200910","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>What about 2016 ?</h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3369","dateFinished":"Mar 28, 2016 12:22:34 PM","dateStarted":"Mar 28, 2016 12:22:34 PM"},{"text":"%pyspark\nword_count_bo_2016_clean.subtractByKey(word_count_bo_2015_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:34 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612419_1157715856","id":"20160328-003652_2114384475","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------------+-----+\n|         word|count|\n+-------------+-----+\n|       voices|    8|\n|       muster|    2|\n|unconditional|    2|\n|      retrain|    2|\n|      walking|    2|\n|        jobs;|    2|\n|      soldier|    2|\n|       unique|    2|\n|    strengths|    2|\n|    isolating|    2|\n|     plotting|    2|\n|       rooted|    2|\n|       gotten|    2|\n| constructive|    2|\n|      unarmed|    2|\n+-------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3370","dateFinished":"Mar 28, 2016 12:22:51 PM","dateStarted":"Mar 28, 2016 12:22:49 PM"},{"text":"%md\n#Coding Exercise\n## What mood was the country in 1790-1796 vs 2009-2015 ?\n### Hint:\n### 1. word_count_gw_clean = 1790-1796-GW.txt\n### 2. word_count_bo_2015_clean\n","dateUpdated":"Mar 28, 2016 12:22:34 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612419_1157715856","id":"20160328-003652_2047964416","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Coding Exercise</h1>\n<h2>What mood was the country in 1790-1796 vs 2009-2015 ?</h2>\n<h3>Hint:</h3>\n<h3>1. word_count_gw_clean = 1790-1796-GW.txt</h3>\n<h3>2. word_count_bo_2015_clean</h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3371","dateFinished":"Mar 28, 2016 12:22:34 PM","dateStarted":"Mar 28, 2016 12:22:34 PM"},{"text":"%md \n# Coding Exercise\n## What mood was the country in 1790-1796 vs 2009-2015 ?\n### POA:\n### 1. Read 1790-1796-GW.txt\n### 2. Process out common words et al\n### 3. Check top 20 words by count\n### 4. Difference & Explain","dateUpdated":"Mar 28, 2016 12:22:34 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612419_1157715856","id":"20160328-003652_270045596","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Coding Exercise</h1>\n<h2>What mood was the country in 1790-1796 vs 2009-2015 ?</h2>\n<h3>POA:</h3>\n<h3>1. Read 1790-1796-GW.txt</h3>\n<h3>2. Process out common words et al</h3>\n<h3>3. Check top 20 words by count</h3>\n<h3>4. Difference &amp; Explain</h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3372","dateFinished":"Mar 28, 2016 12:22:35 PM","dateStarted":"Mar 28, 2016 12:22:34 PM"},{"text":"%pyspark\nprint (\"*** BO-GW\")\nword_count_bo_clean.subtractByKey(word_count_gw_clean).\\\nsortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:34 PM","config":{"enabled":true,"graph":{"mode":"table","height":356,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":6},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612419_1157715856","id":"20160328-003652_1023385861","result":{"code":"SUCCESS","type":"TEXT","msg":"*** BO-GW\n+----------+-----+\n|      word|count|\n+----------+-----+\n|      jobs|  148|\n|   tonight|   84|\n|      help|   81|\n|businesses|   69|\n|    health|   55|\n|      back|   53|\n|       job|   51|\n|    reform|   51|\n|   deficit|   48|\n|      down|   47|\n|     today|   40|\n|   college|   40|\n|     can't|   39|\n|   working|   38|\n|   schools|   36|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3373","dateFinished":"Mar 28, 2016 12:22:52 PM","dateStarted":"Mar 28, 2016 12:22:50 PM"},{"text":"%pyspark\nprint (\"*** GW-BO\")\nword_count_gw_clean.subtractByKey(word_count_bo_clean).\\\nsortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:35 PM","config":{"enabled":true,"graph":{"mode":"table","height":362,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":6},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612419_1157715856","id":"20160328-003652_849637004","result":{"code":"SUCCESS","type":"TEXT","msg":"*** GW-BO\n+----------------+-----+\n|            word|count|\n+----------------+-----+\n|         present|   28|\n|        measures|   26|\n|       provision|   24|\n|representatives:|   24|\n|         indians|   23|\n|         militia|   20|\n|           ought|   19|\n|       gentlemen|   19|\n|          object|   17|\n|         however|   16|\n|    satisfaction|   15|\n|   establishment|   15|\n|             due|   15|\n|         objects|   15|\n|          tribes|   14|\n+----------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3374","dateFinished":"Mar 28, 2016 12:22:53 PM","dateStarted":"Mar 28, 2016 12:22:51 PM"},{"text":"%pyspark\nprint (\"*** GWB-AL\")\ngwb_al = word_count_gwb_clean.subtractByKey(word_count_al_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"])\ngwb_al.show(10)\ngwb_al.registerTempTable(\"gwb_al\")","dateUpdated":"Mar 28, 2016 12:22:35 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612419_1157715856","id":"20160328-003652_1230357325","result":{"code":"SUCCESS","type":"TEXT","msg":"*** GWB-AL\n+----------+-----+\n|      word|count|\n+----------+-----+\n|terrorists|   83|\n|      iraq|   80|\n|   tonight|   76|\n|    terror|   63|\n|   weapons|   56|\n|     iraqi|   48|\n|      jobs|   36|\n|   workers|   36|\n|        al|   36|\n| terrorist|   36|\n+----------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3375","dateFinished":"Mar 28, 2016 12:22:54 PM","dateStarted":"Mar 28, 2016 12:22:52 PM"},{"text":"%sql\nSELECT * FROM gwb_al limit 15","dateUpdated":"Mar 28, 2016 12:23:30 PM","config":{"enabled":true,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"editorMode":"ace/mode/sql","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612419_1157715856","id":"20160328-003652_495524312","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\nterrorists\t83\niraq\t80\ntonight\t76\nterror\t63\nweapons\t56\niraqi\t48\njobs\t36\nworkers\t36\nal\t36\nterrorist\t36\nafghanistan\t35\nqaeda\t32\ngoal\t32\nnuclear\t32\nmillion\t31\n","comment":"","msgTable":[[{"key":"count","value":"terrorists"},{"key":"count","value":"83"}],[{"value":"iraq"},{"value":"80"}],[{"value":"tonight"},{"value":"76"}],[{"value":"terror"},{"value":"63"}],[{"value":"weapons"},{"value":"56"}],[{"value":"iraqi"},{"value":"48"}],[{"value":"jobs"},{"value":"36"}],[{"value":"workers"},{"value":"36"}],[{"value":"al"},{"value":"36"}],[{"value":"terrorist"},{"value":"36"}],[{"value":"afghanistan"},{"value":"35"}],[{"value":"qaeda"},{"value":"32"}],[{"value":"goal"},{"value":"32"}],[{"value":"nuclear"},{"value":"32"}],[{"value":"million"},{"value":"31"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["terrorists","83"],["iraq","80"],["tonight","76"],["terror","63"],["weapons","56"],["iraqi","48"],["jobs","36"],["workers","36"],["al","36"],["terrorist","36"],["afghanistan","35"],["qaeda","32"],["goal","32"],["nuclear","32"],["million","31"]]},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3376","dateFinished":"Mar 28, 2016 12:23:30 PM","dateStarted":"Mar 28, 2016 12:23:30 PM","focus":true},{"text":"%md\n###Now it is easy to see Obama vs. FDR or WJC vs. AL ...","dateUpdated":"Mar 28, 2016 12:22:36 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612419_1157715856","id":"20160328-003652_335528718","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Now it is easy to see Obama vs. FDR or WJC vs. AL &hellip;</h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3377","dateFinished":"Mar 28, 2016 12:22:36 PM","dateStarted":"Mar 28, 2016 12:22:36 PM"},{"text":"%pyspark\nprint (\"*** FDR-BO\")\nword_count_fdr_clean.subtractByKey(word_count_bo_clean).\\\nsortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:36 PM","config":{"enabled":true,"graph":{"mode":"table","height":362,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":6},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612420_1155792112","id":"20160328-003652_2086590051","result":{"code":"SUCCESS","type":"TEXT","msg":"*** FDR-BO\n+------------+-----+\n|        word|count|\n+------------+-----+\n|     present|   39|\n|    japanese|   36|\n|   therefore|   31|\n|   essential|   31|\n|       enemy|   24|\n|        1942|   22|\n|    adequate|   21|\n|     methods|   21|\n|  principles|   20|\n|     peoples|   20|\n|  objectives|   19|\n|        1933|   19|\n|     however|   19|\n| agriculture|   18|\n|civilization|   18|\n+------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3378","dateFinished":"Mar 28, 2016 12:22:55 PM","dateStarted":"Mar 28, 2016 12:22:53 PM"},{"text":"%pyspark\nprint (\"*** BO-FDR\")\nword_count_bo_clean.subtractByKey(word_count_fdr_clean).\\\nsortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:36 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":6},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612420_1155792112","id":"20160328-003652_911031647","result":{"code":"SUCCESS","type":"TEXT","msg":"*** BO-FDR\n+-----------+-----+\n|       word|count|\n+-----------+-----+\n|     energy|   87|\n|    tonight|   84|\n| businesses|   69|\n|    college|   40|\n|    schools|   36|\n|   students|   27|\n|        oil|   26|\n|       kids|   25|\n|republicans|   25|\n| innovation|   24|\n|        gas|   23|\n|  democrats|   23|\n|   research|   22|\n|    nuclear|   21|\n| technology|   20|\n+-----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3379","dateFinished":"Mar 28, 2016 12:22:56 PM","dateStarted":"Mar 28, 2016 12:22:54 PM"},{"text":"%pyspark\nprint (\"*** BO-WJC\")\nword_count_bo_clean.subtractByKey(word_count_wjc_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:36 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612420_1155792112","id":"20160328-003652_150488019","result":{"code":"SUCCESS","type":"TEXT","msg":"*** BO-WJC\n+--------------+-----+\n|          word|count|\n+--------------+-----+\n|           oil|   26|\n| manufacturing|   19|\n|   afghanistan|   18|\n|            al|   15|\n|        afghan|   15|\n|          iran|   12|\n|         solar|   12|\n|         qaeda|   12|\n|          code|   11|\n|    rebuilding|   10|\n|infrastructure|   10|\n|         worse|   10|\n|        breaks|    9|\n|         biden|    9|\n|          wind|    8|\n+--------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3380","dateFinished":"Mar 28, 2016 12:22:57 PM","dateStarted":"Mar 28, 2016 12:22:55 PM"},{"text":"%pyspark\nprint (\"*** BO-GWB\")\nword_count_bo_clean.subtractByKey(word_count_gwb_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:36 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612420_1155792112","id":"20160328-003652_1663882814","result":{"code":"SUCCESS","type":"TEXT","msg":"*** BO-GWB\n+------------+-----+\n|        word|count|\n+------------+-----+\n|       banks|   22|\n|    industry|   20|\n|    trillion|   17|\n|middle-class|   13|\n|        wage|   12|\n|       class|   12|\n|     lending|   11|\n|       forge|   11|\n|         lay|   11|\n|        walk|   11|\n|       helps|   10|\n|     minimum|   10|\n|     restore|   10|\n|      breaks|    9|\n|   high-tech|    9|\n+------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3381","dateFinished":"Mar 28, 2016 12:22:58 PM","dateStarted":"Mar 28, 2016 12:22:56 PM"},{"text":"%pyspark\nprint (\"*** BO-AL\")\nword_count_bo_clean.subtractByKey(word_count_al_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:36 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612420_1155792112","id":"20160328-003652_346403664","result":{"code":"SUCCESS","type":"TEXT","msg":"*** BO-AL\n+----------+-----+\n|      word|count|\n+----------+-----+\n|      jobs|  148|\n|   tonight|   84|\n|businesses|   69|\n|  families|   56|\n|       job|   51|\n|   deficit|   48|\n|     today|   40|\n|   college|   40|\n|     can't|   39|\n|   schools|   36|\n|   million|   36|\n|     clean|   35|\n|   workers|   35|\n|      hard|   32|\n|    budget|   30|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3382","dateFinished":"Mar 28, 2016 12:23:00 PM","dateStarted":"Mar 28, 2016 12:22:57 PM"},{"text":"%pyspark\nprint (\"*** WJC-AL\")\nword_count_wjc_clean.subtractByKey(word_count_al_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:36 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612420_1155792112","id":"20160328-003652_178213831","result":{"code":"SUCCESS","type":"TEXT","msg":"*** WJC-AL\n+---------+-----+\n|     word|count|\n+---------+-----+\n|  tonight|   98|\n| families|   82|\n|   budget|   77|\n|challenge|   76|\n|  parents|   70|\n|  schools|   66|\n|     jobs|   66|\n|    child|   65|\n|  million|   64|\n|    today|   60|\n|    crime|   60|\n|     21st|   58|\n|  college|   54|\n|    thank|   47|\n|     bill|   47|\n+---------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3383","dateFinished":"Mar 28, 2016 12:23:01 PM","dateStarted":"Mar 28, 2016 12:22:58 PM"},{"text":"%pyspark\nprint (\"*** AL-BO\")\nword_count_al_clean.subtractByKey(word_count_bo_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:37 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612420_1155792112","id":"20160328-003652_1647653699","result":{"code":"SUCCESS","type":"TEXT","msg":"*** AL-BO\n+-------------+-----+\n|         word|count|\n+-------------+-----+\n|      persons|   30|\n|      present|   27|\n|        naval|   27|\n| emancipation|   25|\n|consideration|   22|\n|     receipts|   22|\n|      however|   21|\n|     measures|   20|\n|      slavery|   19|\n|      vessels|   17|\n| proclamation|   17|\n|       indian|   17|\n|       powers|   16|\n|     believed|   16|\n|       actual|   16|\n+-------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3384","dateFinished":"Mar 28, 2016 12:23:02 PM","dateStarted":"Mar 28, 2016 12:23:00 PM"},{"text":"%pyspark\nprint (\"*** AL-WJC\")\nword_count_al_clean.subtractByKey(word_count_wjc_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 28, 2016 12:22:37 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612420_1155792112","id":"20160328-003652_314091028","result":{"code":"SUCCESS","type":"TEXT","msg":"*** AL-WJC\n+-------------+-----+\n|         word|count|\n+-------------+-----+\n|      persons|   30|\n|         navy|   28|\n|    condition|   28|\n|        naval|   27|\n| emancipation|   25|\n|         thus|   23|\n|consideration|   22|\n|     receipts|   22|\n|       claims|   20|\n|     interior|   18|\n|      vessels|   17|\n| proclamation|   17|\n|       powers|   16|\n|     believed|   16|\n|       actual|   16|\n+-------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3385","dateFinished":"Mar 28, 2016 12:23:03 PM","dateStarted":"Mar 28, 2016 12:23:01 PM"},{"text":"%md\n## That is All Folks !","dateUpdated":"Mar 28, 2016 12:22:38 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612421_1155407363","id":"20160328-003652_413103270","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>That is All Folks !</h2>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3386","dateFinished":"Mar 28, 2016 12:22:38 PM","dateStarted":"Mar 28, 2016 12:22:38 PM"},{"text":"%md\n## Oh, wait - One More/Last Thing\n### The debates !!!","dateUpdated":"Mar 28, 2016 12:22:38 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612421_1155407363","id":"20160328-003652_212028139","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Oh, wait - One More/Last Thing</h2>\n<h3>The debates !!!</h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3387","dateFinished":"Mar 28, 2016 12:22:39 PM","dateStarted":"Mar 28, 2016 12:22:38 PM"},{"text":"%pyspark\nrd = getWordCount(\"data/sotu/debates/RepublicanDebate-2016.txt\")\nprint rd.count()","dateUpdated":"Mar 28, 2016 12:22:38 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612421_1155407363","id":"20160328-003652_881561800","result":{"code":"SUCCESS","type":"TEXT","msg":"11783\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:02 PM","dateFinished":"Mar 28, 2016 12:23:04 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3388"},{"text":"%pyspark\nrd_1 = rd.sortBy(lambda x: x[1],ascending=False)\nrd_1.toDF([\"word\",\"count\"]).show(5)","dateUpdated":"Mar 28, 2016 12:22:38 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612421_1155407363","id":"20160328-003652_919491947","result":{"code":"SUCCESS","type":"TEXT","msg":"+----+-----+\n|word|count|\n+----+-----+\n| the|12436|\n|    | 9397|\n|  to| 9311|\n| and| 7942|\n|  of| 5535|\n+----+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:03 PM","dateFinished":"Mar 28, 2016 12:23:04 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3389"},{"text":"%pyspark\nrd_clean = rd.filter(lambda x: x[0] not in common_words)\nprint rd_clean.count()\n#\nrd_1 = rd_clean.sortBy(lambda x: x[1],ascending=False)\nrd_1.toDF([\"word\",\"count\"]).show(5)","dateUpdated":"Mar 28, 2016 12:22:38 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"(u'\\u2014', 1881)","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"(u'\\u2014', 1881)","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612421_1155407363","id":"20160328-003652_608829417","result":{"code":"SUCCESS","type":"TEXT","msg":"11670\n+----------+-----+\n|      word|count|\n+----------+-----+\n|         ‚Äî| 1881|\n|    people| 1585|\n|     going| 1228|\n|[applause]|  918|\n|        me|  852|\n+----------+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:04 PM","dateFinished":"Mar 28, 2016 12:23:06 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3390"},{"text":"%pyspark\ndd = getWordCount(\"data/sotu/debates/DemocraticDebate-2016.txt\")\nprint dd.count()\ndd_clean = dd.filter(lambda x: x[0] not in common_words)\nprint dd_clean.count()\n#\ndd_1 = dd_clean.sortBy(lambda x: x[1],ascending=False)\ndd_1.toDF([\"word\",\"count\"]).show(5)","dateUpdated":"Mar 28, 2016 12:22:39 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"(u'people', 787)","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"(u'people', 787)","index":0,"aggr":"sum"}}},"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612421_1155407363","id":"20160328-003652_1983917211","result":{"code":"SUCCESS","type":"TEXT","msg":"8048\n7935\n+----------+-----+\n|      word|count|\n+----------+-----+\n|    people|  787|\n|     think|  609|\n|   senator|  595|\n| secretary|  571|\n|[applause]|  520|\n+----------+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:05 PM","dateFinished":"Mar 28, 2016 12:23:07 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3391"},{"text":"%pyspark\nprint (\"*** RD-DD\")\nrd_clean.subtractByKey(dd_clean).sortBy(lambda x: x[1],\n    ascending= False).toDF([\"word\",\"count\"]).show(10)","dateUpdated":"Mar 28, 2016 12:22:39 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":6,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612421_1155407363","id":"20160328-003652_1865461955","result":{"code":"SUCCESS","type":"TEXT","msg":"*** RD-DD\n+--------+-----+\n|    word|count|\n+--------+-----+\n|  trump:|  787|\n|  rubio:|  429|\n|   cruz:|  384|\n| tapper:|  290|\n|   bush:|  279|\n| kasich:|  234|\n|blitzer:|  209|\n|  kelly:|  206|\n|  kasich|  165|\n|  carson|  154|\n+--------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:06 PM","dateFinished":"Mar 28, 2016 12:23:09 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3392"},{"text":"%pyspark\nprint (\"*** DD-RD\")\ndd_clean.subtractByKey(rd_clean).sortBy(lambda x: x[1],\n    ascending= False).toDF([\"word\",\"count\"]).show(10)","dateUpdated":"Mar 28, 2016 12:22:39 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":6,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612421_1155407363","id":"20160328-003652_1705315132","result":{"code":"SUCCESS","type":"TEXT","msg":"*** DD-RD\n+---------+-----+\n|     word|count|\n+---------+-----+\n| sanders:|  502|\n| clinton:|  452|\n|  cooper:|  279|\n|o'malley:|  163|\n| o'malley|   87|\n|    holt:|   87|\n|    todd:|   66|\n|   ramos:|   56|\n|  maddow:|   43|\n|mitchell:|   41|\n+---------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:07 PM","dateFinished":"Mar 28, 2016 12:23:11 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3393"},{"text":"%pyspark\ncommon2 = ['sanders:','clinton:','clinton','sanders','cooper:',\"o'malley:\",\"o'malley\",'holt:','todd:','ramos:','maddow:',\n    'mitchell:','salinas:','webb:','woodruff:','[through','lemon:','ifill:','webb','andrea','chafee:','trump:','trump','rubio:','cruz:',\n    'tapper:','bush:','kasich:','blitzer:','kelly:','kasich','carson','baier:','wallace:','carson:','paul:','christie:','fiorina:',\n    'bartiromo:','christie','hewitt:','cavuto:','jeb','[applause]','me','your','my','\\u2014','said','out','very','huckabee:','‚Äî','quintanilla:',\n    'harwood:','jake','ben','hugh','baker:','huckabee','walker:','trump?','rand','rubio?','megyn','cruz?','tumulty:','sanders?','chafee',\n    'translator]:',\"lester\",\"martin\"]","dateUpdated":"Mar 28, 2016 12:22:40 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612422_1156561609","id":"20160328-003652_914670662","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:09 PM","dateFinished":"Mar 28, 2016 12:23:11 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3394"},{"text":"%pyspark\nrd_clean = rd_clean.filter(lambda x: x[0] not in common2)\nprint rd_clean.count()\n#\nrd_1 = rd_clean.sortBy(lambda x: x[1],ascending=False)\nrd_1.toDF([\"word\",\"count\"]).show(5)","dateUpdated":"Mar 28, 2016 12:22:40 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"(u'\\u2014', 1881)","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"(u'\\u2014', 1881)","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":6},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612422_1156561609","id":"20160328-003652_1181871008","result":{"code":"SUCCESS","type":"TEXT","msg":"11625\n+-------+-----+\n|   word|count|\n+-------+-----+\n|      ‚Äî| 1881|\n| people| 1585|\n|  going| 1228|\n|country|  813|\n|  think|  808|\n+-------+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:11 PM","dateFinished":"Mar 28, 2016 12:23:13 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3395"},{"text":"%pyspark\ndd_clean = dd_clean.filter(lambda x: x[0] not in common2)\nprint dd_clean.count()\n#\ndd_1 = dd_clean.sortBy(lambda x: x[1],ascending=False)\ndd_1.toDF([\"word\",\"count\"]).show(5)","dateUpdated":"Mar 28, 2016 12:22:40 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":6,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612422_1156561609","id":"20160328-003652_1629780353","result":{"code":"SUCCESS","type":"TEXT","msg":"7900\n+---------+-----+\n|     word|count|\n+---------+-----+\n|   people|  787|\n|    think|  609|\n|  senator|  595|\n|secretary|  571|\n|    going|  509|\n+---------+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:12 PM","dateFinished":"Mar 28, 2016 12:23:14 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3396"},{"text":"%pyspark\nprint (\"*** RD-DD\")\nrd_1.subtractByKey(dd_1).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(10)","dateUpdated":"Mar 28, 2016 12:22:41 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":6,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612422_1156561609","id":"20160328-003652_564475386","result":{"code":"SUCCESS","type":"TEXT","msg":"*** RD-DD\n+----------+-----+\n|      word|count|\n+----------+-----+\n|   amnesty|   67|\n|    quick:|   64|\n|     [bell|   58|\n|   islamic|   56|\n|    rings]|   39|\n|       fed|   37|\n|retirement|   32|\n|       irs|   29|\n|       fox|   28|\n|        $2|   27|\n+----------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:13 PM","dateFinished":"Mar 28, 2016 12:23:15 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3397"},{"text":"%pyspark\nprint (\"*** DD-RD\")\ndd_1.subtractByKey(rd_1).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(10)","dateUpdated":"Mar 28, 2016 12:22:41 PM","config":{"enabled":true,"graph":{"mode":"table","height":275,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":6,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612422_1156561609","id":"20160328-003652_1702543703","result":{"code":"SUCCESS","type":"TEXT","msg":"*** DD-RD\n+--------------+-----+\n|          word|count|\n+--------------+-----+\n|        fossil|   23|\n|glass-steagall|   21|\n|      immunity|   19|\n|        racism|   18|\n|     crumbling|   17|\n|        rigged|   15|\n|     debt-free|   15|\n|          koch|   14|\n|   (inaudible)|   13|\n|       cordes:|   13|\n+--------------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:14 PM","dateFinished":"Mar 28, 2016 12:23:16 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3398"},{"text":"%md\n### TF-IDF as Feature Extraction","dateUpdated":"Mar 28, 2016 12:22:42 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612422_1156561609","id":"20160328-003652_1579903693","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>TF-IDF as Feature Extraction</h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:22:43 PM","dateFinished":"Mar 28, 2016 12:22:43 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3399"},{"text":"%pyspark\ndocuments = sc.textFile(\"data/sotu/debates/\").map(lambda line: line.split(\" \"))\nprint documents.count()\nprint documents.take(3)","dateUpdated":"Mar 28, 2016 12:22:43 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612422_1156561609","id":"20160328-003652_1953556743","result":{"code":"SUCCESS","type":"TEXT","msg":"26067\n[[u'Democratic', u'Candidates', u'Debate', u'in', u'Las', u'Vegas,', u'Nevada'], [u'October', u'13,', u'2015'], [u'']]\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:15 PM","dateFinished":"Mar 28, 2016 12:23:16 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3400"},{"text":"%pyspark\nfrom pyspark.mllib.feature import HashingTF,IDF\nhashingTF = HashingTF()\ntf = hashingTF.transform(documents)\nprint tf.take(10)\n#\ntf.cache()\nidf = IDF().fit(tf)\ntfidf = idf.transform(tf)\nprint tfidf.take(10)","dateUpdated":"Mar 28, 2016 12:22:43 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612422_1156561609","id":"20160328-003652_550700618","result":{"code":"SUCCESS","type":"TEXT","msg":"[SparseVector(1048576, {50583: 1.0, 157821: 1.0, 203611: 1.0, 244091: 1.0, 648596: 1.0, 896959: 1.0, 980744: 1.0}), SparseVector(1048576, {334392: 1.0, 911683: 1.0, 1014287: 1.0}), SparseVector(1048576, {0: 1.0}), SparseVector(1048576, {972429: 1.0}), SparseVector(1048576, {163308: 1.0, 686269: 1.0, 709582: 1.0, 744258: 1.0, 978010: 1.0}), SparseVector(1048576, {63634: 1.0, 304434: 1.0, 323305: 1.0, 648543: 1.0, 657242: 1.0, 686269: 1.0}), SparseVector(1048576, {141783: 1.0, 182622: 1.0, 418582: 1.0, 686269: 1.0, 709582: 1.0}), SparseVector(1048576, {639967: 1.0, 944417: 1.0, 1006297: 1.0, 1012455: 1.0}), SparseVector(1048576, {133344: 1.0, 399371: 1.0, 577702: 1.0, 686269: 1.0, 1006297: 1.0}), SparseVector(1048576, {1007897: 1.0})]\n[SparseVector(1048576, {50583: 1.8225, 157821: 6.8363, 203611: 5.2268, 244091: 8.2226, 648596: 6.9104, 896959: 7.5294, 980744: 8.3767}), SparseVector(1048576, {334392: 7.8659, 911683: 8.559, 1014287: 8.7822}), SparseVector(1048576, {0: 0.7008}), SparseVector(1048576, {972429: 3.7732}), SparseVector(1048576, {163308: 9.0699, 686269: 6.4796, 709582: 3.7883, 744258: 8.7822, 978010: 9.4753}), SparseVector(1048576, {63634: 6.1982, 304434: 4.6001, 323305: 1.6493, 648543: 4.1282, 657242: 7.9712, 686269: 6.4796}), SparseVector(1048576, {141783: 7.6836, 182622: 7.033, 418582: 8.559, 686269: 6.4796, 709582: 3.7883}), SparseVector(1048576, {639967: 6.1982, 944417: 5.0996, 1006297: 3.3109, 1012455: 7.9712}), SparseVector(1048576, {133344: 7.9712, 399371: 7.6035, 577702: 9.4753, 686269: 6.4796, 1006297: 3.3109}), SparseVector(1048576, {1007897: 7.224})]\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","dateStarted":"Mar 28, 2016 12:23:16 PM","dateFinished":"Mar 28, 2016 12:23:18 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3401"},{"text":"%md\n### We can see the features, but not easy to go back to the word vector from the hashes\n### TF-IDF is useful as a part of the pipeline towards ML algorithms like Classification\n### _That is why HashingTF and IDF are part of pyspark.mllib.feature_","dateUpdated":"Mar 28, 2016 12:22:44 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612423_1156176860","id":"20160328-003652_2118251803","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>We can see the features, but not easy to go back to the word vector from the hashes</h3>\n<h3>TF-IDF is useful as a part of the pipeline towards ML algorithms like Classification</h3>\n<h3><em>That is why HashingTF and IDF are part of pyspark.mllib.feature</em></h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3402","dateFinished":"Mar 28, 2016 12:22:45 PM","dateStarted":"Mar 28, 2016 12:22:45 PM"},{"text":"%md\n### ML API to Rescue","dateUpdated":"Mar 28, 2016 12:22:45 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612423_1156176860","id":"20160328-003652_474153055","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>ML API to Rescue</h3>\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3403","dateFinished":"Mar 28, 2016 12:22:46 PM","dateStarted":"Mar 28, 2016 12:22:45 PM"},{"text":"%pyspark\nfrom pyspark.ml.feature import HashingTF, IDF, Tokenizer\n\nsentenceData = sqlContext.createDataFrame([\n    (0, \"Hi I heard about Spark\"),\n    (0, \"I wish Java could use case classes\"),\n    (1, \"Logistic regression models are neat\")\n], [\"label\", \"sentence\"])\ntokenizer = Tokenizer(inputCol=\"sentence\", outputCol=\"words\")\nwordsData = tokenizer.transform(sentenceData)\nhashingTF = HashingTF(inputCol=\"words\", outputCol=\"rawFeatures\", numFeatures=20)\nfeaturizedData = hashingTF.transform(wordsData)\nidf = IDF(inputCol=\"rawFeatures\", outputCol=\"features\")\nidfModel = idf.fit(featurizedData)\nrescaledData = idfModel.transform(featurizedData)\nfor features_label in rescaledData.select(\"features\", \"label\").take(3):\n    print(features_label)","dateUpdated":"Mar 28, 2016 12:22:45 PM","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612423_1156176860","id":"20160328-003652_1926065015","result":{"code":"SUCCESS","type":"TEXT","msg":"Row(features=SparseVector(20, {5: 0.0, 6: 0.6931, 9: 1.3863}), label=0)\nRow(features=SparseVector(20, {3: 1.3863, 5: 0.0, 12: 0.2877, 14: 0.2877, 18: 0.2877}), label=0)\nRow(features=SparseVector(20, {5: 0.0, 12: 0.5754, 14: 0.2877, 18: 0.2877}), label=1)\n"},"dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3404","dateFinished":"Mar 28, 2016 12:23:19 PM","dateStarted":"Mar 28, 2016 12:23:16 PM"},{"dateUpdated":"Mar 28, 2016 12:22:45 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459150612423_1156176860","id":"20160328-003652_206212227","dateCreated":"Mar 28, 2016 12:36:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3405","dateFinished":"Mar 28, 2016 12:23:18 PM","dateStarted":"Mar 28, 2016 12:23:18 PM","result":{"code":"SUCCESS","type":"TEXT"}}],"name":"03-Text Analytics-X","id":"2BEBWYTTF","angularObjects":{"2BFJWMQ9H":[],"2BE8A7YV6":[],"2BG1VHWRJ":[],"2BEKJ6EK5":[],"2BF216UPS":[],"2BEZ62K9N":[],"2BD587MW7":[],"2BE7MJQ3Z":[],"2BFKH5WZX":[],"2BDJW333S":[],"2BEB288BJ":[],"2BFAUCSV2":[],"2BFK98EU6":[],"2BCTH3CWC":[]},"config":{"looknfeel":"default"},"info":{}}