{"paragraphs":[{"text":"%md\n## Text Analytics\n#### In which we analyze the Mood of the nation from inferences on SOTU by the POTUS\n####   (State Of The Union addresses by the President Of The US)\n \n#####Goal is to find interesting words in the speeches that reflect the times.\n \n#####Am sure Lincoln didn't worry about WMDs and Iraq; neither did George Washington about inflation, Wall Street and Jobs.","dateUpdated":"Mar 25, 2016 10:39:16 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458171087043_-330359374","id":"20160316-163127_1174451799","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Text Analytics</h2>\n<h4>In which we analyze the Mood of the nation from inferences on SOTU by the POTUS</h4>\n<h4>(State Of The Union addresses by the President Of The US)</h4>\n<h5>Goal is to find interesting words in the speeches that reflect the times.</h5>\n<h5>Am sure Lincoln didn't worry about WMDs and Iraq; neither did George Washington about inflation, Wall Street and Jobs.</h5>\n"},"dateCreated":"Mar 16, 2016 4:31:27 PM","dateStarted":"Mar 25, 2016 10:39:16 PM","dateFinished":"Mar 25, 2016 10:39:16 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3352"},{"text":"%pyspark\nfrom pyspark.context import SparkContext\nprint \"Running Spark Version %s\" % (sc.version)","dateUpdated":"Mar 25, 2016 10:39:19 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458171204578_-1939025173","id":"20160316-163324_1320845061","result":{"code":"SUCCESS","type":"TEXT","msg":"Running Spark Version 1.6.0\n"},"dateCreated":"Mar 16, 2016 4:33:24 PM","dateStarted":"Mar 25, 2016 10:39:19 PM","dateFinished":"Mar 25, 2016 10:39:19 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3353"},{"text":"%pyspark\nfrom pyspark.conf import SparkConf\nconf = SparkConf()\nprint conf.toDebugString()","dateUpdated":"Mar 25, 2016 10:39:21 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458171265535_423256453","id":"20160316-163425_1873247502","result":{"code":"SUCCESS","type":"TEXT","msg":"\n"},"dateCreated":"Mar 16, 2016 4:34:25 PM","dateStarted":"Mar 25, 2016 10:39:21 PM","dateFinished":"Mar 25, 2016 10:39:21 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3354"},{"text":"%md\n#### MapReduce in one line !\n#### 1. Split lines into words on space\n#### 2. Create key-value pair with key=word, value = 1\n#### 3. Sum value for each word (er ... key)\n#### 4. Then we get key-value RDD with key=word and value = number of times the word occured in a document","dateUpdated":"Mar 25, 2016 10:39:25 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458171376383_1603787027","id":"20160316-163616_1145585578","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>MapReduce in one line !</h4>\n<h4>1. Split lines into words on space</h4>\n<h4>2. Create key-value pair with key=word, value = 1</h4>\n<h4>3. Sum value for each word (er &hellip; key)</h4>\n<h4>4. Then we get key-value RDD with key=word and value = number of times the word occured in a document</h4>\n"},"dateCreated":"Mar 16, 2016 4:36:16 PM","dateStarted":"Mar 25, 2016 10:39:25 PM","dateFinished":"Mar 25, 2016 10:39:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3355"},{"text":"%pyspark\n# imports\nfrom operator import add","dateUpdated":"Mar 25, 2016 10:39:29 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458171455635_-1509292945","id":"20160316-163735_2091062738","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Mar 16, 2016 4:37:35 PM","dateStarted":"Mar 25, 2016 10:39:29 PM","dateFinished":"Mar 25, 2016 10:39:29 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3356"},{"text":"%md ###Let us strip the unwanted characters and convert all words to lowercase","dateUpdated":"Mar 25, 2016 10:39:32 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458257470994_-949417645","id":"20160317-163110_2120415420","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Let us strip the unwanted characters and convert all words to lowercase</h3>\n"},"dateCreated":"Mar 17, 2016 4:31:10 PM","dateStarted":"Mar 25, 2016 10:39:33 PM","dateFinished":"Mar 25, 2016 10:39:33 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3357"},{"text":"%pyspark\nlines = sc.textFile(\"data/sotu/2009-2014-BO.txt\")\nword_count_bo = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.'), 1)).\\\n    reduceByKey(add)\nprint word_count_bo.count()\n# 6658 without lower, 6299 with lower, rstrip,lstrip 4835\n","dateUpdated":"Mar 25, 2016 10:39:35 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458171673113_582292377","id":"20160316-164113_1813297229","result":{"code":"SUCCESS","type":"TEXT","msg":"4835\n"},"dateCreated":"Mar 16, 2016 4:41:13 PM","dateStarted":"Mar 25, 2016 10:39:35 PM","dateFinished":"Mar 25, 2016 10:39:36 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3358"},{"text":"%pyspark\nlines = sc.textFile(\"data/sotu/2009-2015-BO.txt\")\nword_count_bo_2015 = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.').replace(u\"\\u2019\", \"'\"), 1)).\\\n    reduceByKey(add)\nprint word_count_bo_2015.count()","dateUpdated":"Mar 25, 2016 10:39:39 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458171754566_1372706180","id":"20160316-164234_1126774053","result":{"code":"SUCCESS","type":"TEXT","msg":"5275\n"},"dateCreated":"Mar 16, 2016 4:42:34 PM","dateStarted":"Mar 25, 2016 10:39:39 PM","dateFinished":"Mar 25, 2016 10:39:40 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3359"},{"text":"%pyspark\nlines = sc.textFile(\"data/sotu/2016-BO.txt\")\nword_count_bo_2016 = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.').replace(u\"\\u2019\", \"'\"), 1)).\\\n    reduceByKey(add)\nprint word_count_bo_2016.count()","dateUpdated":"Mar 25, 2016 10:39:43 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458172703820_1285696565","id":"20160316-165823_615764547","result":{"code":"SUCCESS","type":"TEXT","msg":"1589\n"},"dateCreated":"Mar 16, 2016 4:58:23 PM","dateStarted":"Mar 25, 2016 10:39:43 PM","dateFinished":"Mar 25, 2016 10:39:43 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3360"},{"text":"%pyspark\nlines = sc.textFile(\"data/sotu/2001-2008-GWB.txt\")\nword_count_gwb = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.'), 1)).\\\n    reduceByKey(add)\nprint word_count_gwb.count()","dateUpdated":"Mar 25, 2016 10:39:54 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458172394290_-1280454361","id":"20160316-165314_1957285821","result":{"code":"SUCCESS","type":"TEXT","msg":"4957\n"},"dateCreated":"Mar 16, 2016 4:53:14 PM","dateStarted":"Mar 25, 2016 10:39:54 PM","dateFinished":"Mar 25, 2016 10:39:55 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3361"},{"text":"%pyspark\nlines = sc.textFile(\"data/sotu/1994-2000-WJC.txt\")\nword_count_wjc = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.'), 1)).\\\n    reduceByKey(add)\nprint \"WJC = %d\" %(word_count_wjc.count())\n#\nlines = sc.textFile(\"data/sotu/1961-1963-JFK.txt\")\nword_count_jfk = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.'), 1)).\\\n    reduceByKey(add)\nprint \"JFK = %d\" %(word_count_jfk.count())\n#\nlines = sc.textFile(\"data/sotu/1934-1945-FDR.txt\")\nword_count_fdr = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.'), 1)).\\\n    reduceByKey(add)\nprint \"FDR = %d\" %(word_count_fdr.count())\n#\nlines = sc.textFile(\"data/sotu/1861-1864-AL.txt\")\nword_count_al = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.'), 1)).\\\n    reduceByKey(add)\nprint \"AL  = %d\" %(word_count_al.count())\n#\nlines = sc.textFile(\"data/sotu/1790-1796-GW.txt\")\nword_count_gw = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.'), 1)).\\\n    reduceByKey(add)\nprint \"GW  = %d\" %(word_count_gw.count())\n","dateUpdated":"Mar 25, 2016 10:39:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458172648280_-220118685","id":"20160316-165728_2011632679","result":{"code":"SUCCESS","type":"TEXT","msg":"WJC = 5476\nJFK = 3656\nFDR = 5933\nAL  = 4156\nGW  = 2951\n"},"dateCreated":"Mar 16, 2016 4:57:28 PM","dateStarted":"Mar 25, 2016 10:39:57 PM","dateFinished":"Mar 25, 2016 10:39:58 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3362"},{"text":"%pyspark\nBO_df = word_count_bo.sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"])\nBO_df.show(5)\nBO_df.registerTempTable(\"BO\")","dateUpdated":"Mar 25, 2016 10:45:31 PM","config":{"colWidth":12,"graph":{"mode":"table","height":160,"optionOpen":false,"keys":[{"name":"(u'the', 1812)","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"(u'the', 1812)","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458175283790_2001873720","id":"20160316-174123_854197550","result":{"code":"SUCCESS","type":"TEXT","msg":"+----+-----+\n|word|count|\n+----+-----+\n| the| 1812|\n| and| 1375|\n|  to| 1351|\n|  of| 1013|\n|   a|  802|\n+----+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 16, 2016 5:41:23 PM","dateStarted":"Mar 25, 2016 10:45:31 PM","dateFinished":"Mar 25, 2016 10:45:31 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3363"},{"text":"%sql\nSELECT * FROM BO LIMIT 15","dateUpdated":"Mar 25, 2016 10:43:44 PM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":290,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458970877139_-1094660749","id":"20160325-224117_21436793","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\nthe\t1812\nand\t1375\nto\t1351\nof\t1013\na\t802\nthat\t778\nwe\t719\nour\t698\nin\t637\n\t585\nfor\t411\nis\t370\nwill\t355\nthis\t332\ni\t331\n","comment":"","msgTable":[[{"key":"count","value":"the"},{"key":"count","value":"1812"}],[{"value":"and"},{"value":"1375"}],[{"value":"to"},{"value":"1351"}],[{"value":"of"},{"value":"1013"}],[{"value":"a"},{"value":"802"}],[{"value":"that"},{"value":"778"}],[{"value":"we"},{"value":"719"}],[{"value":"our"},{"value":"698"}],[{"value":"in"},{"value":"637"}],[{"value":""},{"value":"585"}],[{"value":"for"},{"value":"411"}],[{"value":"is"},{"value":"370"}],[{"value":"will"},{"value":"355"}],[{"value":"this"},{"value":"332"}],[{"value":"i"},{"value":"331"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["the","1812"],["and","1375"],["to","1351"],["of","1013"],["a","802"],["that","778"],["we","719"],["our","698"],["in","637"],["","585"],["for","411"],["is","370"],["will","355"],["this","332"],["i","331"]]},"dateCreated":"Mar 25, 2016 10:41:17 PM","dateStarted":"Mar 25, 2016 10:42:06 PM","dateFinished":"Mar 25, 2016 10:42:06 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3364"},{"text":"%md ### Yikes, we need to filter out the common words","dateUpdated":"Mar 17, 2016 4:24:47 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458257068015_-772079051","id":"20160317-162428_1384224613","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Yikes, we need to filter out the common words</h3>\n"},"dateCreated":"Mar 17, 2016 4:24:28 PM","dateStarted":"Mar 17, 2016 4:24:47 PM","dateFinished":"Mar 17, 2016 4:24:47 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3365"},{"text":"%pyspark\ncommon_words = [\"\",\"us\",\"has\",\"all\", \"they\", \"from\", \"who\",\"what\",\"on\",\"by\",\"more\",\"as\",\"not\",\"their\",\"can\",\n                             \"new\",\"it\",\"but\",\"be\",\"are\",\"--\",\"i\",\"have\",\"this\",\"will\",\"for\",\"with\",\"is\",\"that\",\"in\",\n                             \"our\",\"we\",\"a\",\"of\",\"to\",\"and\",\"the\",\"that's\",\"or\",\"make\",\"do\",\"you\",\"at\",\"it\\'s\",\"than\",\n                             \"if\",\"know\",\"last\",\"about\",\"no\",\"just\",\"now\",\"an\",\"because\",\"<p>we\",\"why\",\"we\\'ll\",\"how\",\n                             \"two\",\"also\",\"every\",\"come\",\"we've\",\"year\",\"over\",\"get\",\"take\",\"one\",\"them\",\"we\\'re\",\"need\",\n                             \"want\",\"when\",\"like\",\"most\",\"-\",\"been\",\"first\",\"where\",\"so\",\"these\",\"they\\'re\",\"good\",\"would\",\n                             \"there\",\"should\",\"-->\",\"<!--\",\"up\",\"i\\'m\",\"his\",\"their\",\"which\",\"may\",\"were\",\"such\",\"some\",\n                             \"those\",\"was\",\"here\",\"she\",\"he\",\"its\",\"her\",\"his\",\"don\\'t\",\"i\\'ve\",\"what\\'s\",\"didn\\'t\",\n                             \"shouldn\\'t\",\"(applause.)\",\"let\\'s\",\"doesn\\'t\",\"(laughter.)\",\"any\",\"other\",\"america\",\"american\",\"americans\",\"must\"]\n# This is my list. Would be useful for other projects as well. You can add your own","dateUpdated":"Mar 25, 2016 11:02:51 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458173070584_-1200225207","id":"20160316-170430_1359648763","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Mar 16, 2016 5:04:30 PM","dateStarted":"Mar 25, 2016 11:02:51 PM","dateFinished":"Mar 25, 2016 11:02:51 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3366"},{"text":"%pyspark\nword_count_bo_clean = word_count_bo_1.filter(lambda x: x[0] not in common_words)\nprint word_count_bo_clean.count()\nbo_df = word_count_bo_clean.toDF([\"word\",\"count\"])\nbo_df.show(10)","dateUpdated":"Mar 25, 2016 11:02:56 PM","config":{"colWidth":12,"graph":{"mode":"table","height":280,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458175663283_-1696780398","id":"20160316-174743_373570943","result":{"code":"SUCCESS","type":"TEXT","msg":"4722\n+--------+-----+\n|    word|count|\n+--------+-----+\n|    jobs|  148|\n|  people|  144|\n|   years|  116|\n|    work|  108|\n|    time|   89|\n|  energy|   87|\n| tonight|   84|\n|congress|   83|\n| country|   82|\n|    help|   81|\n+--------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 16, 2016 5:47:43 PM","dateStarted":"Mar 25, 2016 11:02:56 PM","dateFinished":"Mar 25, 2016 11:02:56 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3367"},{"text":"%pyspark\nword_count_bo_2015_clean = word_count_bo_2015.filter(lambda x: x[0] not in common_words)\nword_count_bo_2016_clean = word_count_bo_2016.filter(lambda x: x[0] not in common_words)\n#\nword_count_gwb_clean = word_count_gwb.filter(lambda x: x[0] not in common_words)\nword_count_gwb_clean.count()\n#\nword_count_wjc_clean = word_count_wjc.filter(lambda x: x[0] not in common_words)\nprint \"*** WJC = %d\" %(word_count_wjc_clean.count())\n#\nword_count_jfk_clean = word_count_jfk.filter(lambda x: x[0] not in common_words)\nprint \"*** JFK = %d\" %(word_count_jfk_clean.count())\n#\nword_count_fdr_clean = word_count_fdr.filter(lambda x: x[0] not in common_words)\nprint \"*** FDR = %d\" %(word_count_fdr_clean.count())\n#\nword_count_al_clean = word_count_al.filter(lambda x: x[0] not in common_words)\nprint \"*** AL = %d\" %(word_count_al_clean.count())\n#\nword_count_gw_clean = word_count_gw.filter(lambda x: x[0] not in common_words)\nprint \"*** GW = %d\" %(word_count_gw_clean.count())","dateUpdated":"Mar 25, 2016 11:03:02 PM","config":{"colWidth":12,"graph":{"mode":"table","height":84,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458175771889_1252086770","id":"20160316-174931_722723594","result":{"code":"SUCCESS","type":"TEXT","msg":"*** WJC = 5365\n*** JFK = 3560\n*** FDR = 5834\n*** AL = 4059\n*** GW = 2862\n"},"dateCreated":"Mar 16, 2016 5:49:31 PM","dateStarted":"Mar 25, 2016 11:03:02 PM","dateFinished":"Mar 25, 2016 11:03:02 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3368"},{"text":"%pyspark\ngwb_df = word_count_gwb_clean.toDF([\"word\",\"count\"])\ngwb_df.sort(\"count\",ascending=False).show(15)","dateUpdated":"Mar 25, 2016 11:03:08 PM","config":{"colWidth":6,"graph":{"mode":"table","height":345,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458971603450_-1782516806","id":"20160325-225323_1371752814","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------+-----+\n|      word|count|\n+----------+-----+\n|    people|  158|\n|     world|  131|\n|   country|  108|\n|  congress|   99|\n|  security|   98|\n|      help|   90|\n|    nation|   88|\n|terrorists|   83|\n|      iraq|   80|\n|   freedom|   79|\n|   tonight|   76|\n|government|   73|\n|   economy|   70|\n|     years|   69|\n|    health|   68|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 25, 2016 10:53:23 PM","dateStarted":"Mar 25, 2016 11:03:08 PM","dateFinished":"Mar 25, 2016 11:03:08 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3369"},{"text":"%pyspark\nal_df = word_count_al_clean.toDF([\"word\",\"count\"])\nal_df.sort(\"count\",ascending=False).show(15)","dateUpdated":"Mar 25, 2016 11:03:10 PM","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458972091301_1202088205","id":"20160325-230131_1827439782","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------+-----+\n|      word|count|\n+----------+-----+\n|    states|  148|\n|      upon|   84|\n|    united|   81|\n|  congress|   77|\n|government|   73|\n|    people|   70|\n|       war|   64|\n|   country|   62|\n|     great|   61|\n|     shall|   53|\n|     union|   53|\n|      time|   51|\n|     under|   50|\n|  national|   49|\n|    public|   48|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 25, 2016 11:01:31 PM","dateStarted":"Mar 25, 2016 11:03:10 PM","dateFinished":"Mar 25, 2016 11:03:10 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3370"},{"text":"%pyspark\nwjc_df = word_count_wjc_clean.toDF([\"word\",\"count\"])\nwjc_df.sort(\"count\",ascending=False).show(15)","dateUpdated":"Mar 25, 2016 11:00:27 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458972007317_710040334","id":"20160325-230007_1586153868","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------+-----+\n|    word|count|\n+--------+-----+\n|  people|  266|\n|    work|  194|\n|   years|  176|\n|children|  153|\n|congress|  147|\n|    help|  117|\n|    care|  116|\n|   world|  108|\n|  health|  102|\n| tonight|   98|\n| support|   93|\n|     ask|   92|\n|      my|   91|\n|    time|   91|\n| century|   89|\n+--------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 25, 2016 11:00:07 PM","dateStarted":"Mar 25, 2016 11:00:27 PM","dateFinished":"Mar 25, 2016 11:00:27 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3371"},{"text":"%pyspark\nfdr_df = word_count_fdr_clean.toDF([\"word\",\"count\"])\nfdr_df.sort(\"count\",ascending=False).show(15)","dateUpdated":"Mar 25, 2016 11:05:19 PM","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458972230344_1267662440","id":"20160325-230350_636987125","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------+-----+\n|      word|count|\n+----------+-----+\n|       war|  238|\n|     world|  167|\n|government|  154|\n|    people|  141|\n|  national|  130|\n|    nation|  122|\n|   nations|  111|\n|     peace|  111|\n|    united|  106|\n|  congress|  105|\n|      many|   94|\n|      time|   91|\n|     great|   91|\n|       men|   87|\n|     shall|   86|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 25, 2016 11:03:50 PM","dateStarted":"Mar 25, 2016 11:04:26 PM","dateFinished":"Mar 25, 2016 11:04:27 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3372"},{"text":"%pyspark\ngw_df = word_count_gw_clean.toDF([\"word\",\"count\"])\ngw_df.sort(\"count\",ascending=False).show(15)","dateUpdated":"Mar 25, 2016 11:05:26 PM","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458972291010_65984355","id":"20160325-230451_1387107191","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------+-----+\n|      word|count|\n+----------+-----+\n|    states|   91|\n|    united|   86|\n|    public|   54|\n|      your|   47|\n|government|   47|\n|      made|   39|\n|      upon|   38|\n|        my|   37|\n|  citizens|   33|\n|     state|   32|\n|   country|   31|\n|     peace|   30|\n|     shall|   30|\n|   present|   28|\n|  congress|   27|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 25, 2016 11:04:51 PM","dateStarted":"Mar 25, 2016 11:05:04 PM","dateFinished":"Mar 25, 2016 11:05:04 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3373"},{"text":"%md\n### Has Barack Obama changed in 2015 ?\n### As reflected in the SOTU 2009-2015 vs SOTU 2009-2014 ?","dateUpdated":"Mar 16, 2016 5:58:56 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458176284066_227232836","id":"20160316-175804_559413587","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Has Barack Obama changed in 2015 ?</h3>\n<h3>As reflected in the SOTU 2009-2015 vs SOTU 2009-2014 ?</h3>\n"},"dateCreated":"Mar 16, 2016 5:58:04 PM","dateStarted":"Mar 16, 2016 5:58:56 PM","dateFinished":"Mar 16, 2016 5:58:56 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3374"},{"text":"%pyspark\nword_count_bo_2015_clean.subtractByKey(word_count_bo_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:23:29 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458176336004_1553755099","id":"20160316-175856_1407970131","result":{"code":"SUCCESS","type":"TEXT","msg":"+------------+-----+\n|        word|count|\n+------------+-----+\n|   childcare|    8|\n|     rebekah|    7|\n|   economics|    5|\n|    believed|    4|\n|        cuba|    4|\n|         ben|    3|\n|  (applause)|    3|\n|       fears|    3|\n|twenty-first|    3|\n|       ben's|    2|\n|      speech|    2|\n|      sights|    2|\n|      keeper|    2|\n|   misguided|    2|\n|    constant|    2|\n+------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 16, 2016 5:58:56 PM","dateStarted":"Mar 25, 2016 11:23:29 PM","dateFinished":"Mar 25, 2016 11:23:30 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3375"},{"text":"%md\n### What about 2016 ?","dateUpdated":"Mar 16, 2016 5:59:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458176347887_-1440745591","id":"20160316-175907_386955546","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>What about 2016 ?</h3>\n"},"dateCreated":"Mar 16, 2016 5:59:07 PM","dateStarted":"Mar 16, 2016 5:59:57 PM","dateFinished":"Mar 16, 2016 5:59:57 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3376"},{"text":"%pyspark\nword_count_bo_2016_clean.subtractByKey(word_count_bo_2015_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:24:38 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458176397691_1448996128","id":"20160316-175957_136180040","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------------+-----+\n|         word|count|\n+-------------+-----+\n|       voices|    8|\n|       muster|    2|\n|unconditional|    2|\n|      retrain|    2|\n|      walking|    2|\n|        jobs;|    2|\n|      soldier|    2|\n|       unique|    2|\n|    strengths|    2|\n|    isolating|    2|\n|     plotting|    2|\n|       rooted|    2|\n|       gotten|    2|\n| constructive|    2|\n|      unarmed|    2|\n+-------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 16, 2016 5:59:57 PM","dateStarted":"Mar 25, 2016 11:24:38 PM","dateFinished":"Mar 25, 2016 11:24:39 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3377"},{"text":"%md\n#Coding Exercise\n## What mood was the country in 1790-1796 vs 2009-2015 ?\n### Hint:\n### 1. word_count_gw_clean = 1790-1796-GW.txt\n### 2. word_count_bo_2015_clean\n","dateUpdated":"Mar 16, 2016 6:04:46 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458176472109_1560881438","id":"20160316-180112_651370565","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Coding Exercise</h1>\n<h2>What mood was the country in 1790-1796 vs 2009-2015 ?</h2>\n<h3>Hint:</h3>\n<h3>1. word_count_gw_clean = 1790-1796-GW.txt</h3>\n<h3>2. word_count_bo_2015_clean</h3>\n"},"dateCreated":"Mar 16, 2016 6:01:12 PM","dateStarted":"Mar 16, 2016 6:04:46 PM","dateFinished":"Mar 16, 2016 6:04:46 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3378"},{"text":"%md \n# Coding Exercise\n## What mood was the country in 1790-1796 vs 2009-2015 ?\n### POA:\n### 1. Read 1790-1796-GW.txt\n### 2. Process out common words et al\n### 3. Check top 20 words by count\n### 4. Difference & Explain","dateUpdated":"Mar 26, 2016 12:44:44 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458257181541_473923422","id":"20160317-162621_1993991216","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Coding Exercise</h1>\n<h2>What mood was the country in 1790-1796 vs 2009-2015 ?</h2>\n<h3>POA:</h3>\n<h3>1. Read 1790-1796-GW.txt</h3>\n<h3>2. Process out common words et al</h3>\n<h3>3. Check top 20 words by count</h3>\n<h3>4. Difference &amp; Explain</h3>\n"},"dateCreated":"Mar 17, 2016 4:26:21 PM","dateStarted":"Mar 26, 2016 12:44:44 PM","dateFinished":"Mar 26, 2016 12:44:45 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3379","focus":true},{"text":"%pyspark\nprint (\"*** BO-GW\")\nword_count_bo_clean.subtractByKey(word_count_gw_clean).\\\nsortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:27:50 PM","config":{"colWidth":6,"graph":{"mode":"table","height":356,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458176686359_-665585471","id":"20160316-180446_154444773","result":{"code":"SUCCESS","type":"TEXT","msg":"*** BO-GW\n+----------+-----+\n|      word|count|\n+----------+-----+\n|      jobs|  148|\n|   tonight|   84|\n|      help|   81|\n|businesses|   69|\n|    health|   55|\n|      back|   53|\n|       job|   51|\n|    reform|   51|\n|   deficit|   48|\n|      down|   47|\n|   college|   40|\n|     today|   40|\n|     can't|   39|\n|   working|   38|\n|   schools|   36|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 16, 2016 6:04:46 PM","dateStarted":"Mar 25, 2016 11:27:50 PM","dateFinished":"Mar 25, 2016 11:27:50 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3380"},{"text":"%pyspark\nprint (\"*** GW-BO\")\nword_count_gw_clean.subtractByKey(word_count_bo_clean).\\\nsortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:28:24 PM","config":{"colWidth":6,"graph":{"mode":"table","height":362,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458195790866_-2142675222","id":"20160316-232310_941292946","result":{"code":"SUCCESS","type":"TEXT","msg":"*** GW-BO\n+----------------+-----+\n|            word|count|\n+----------------+-----+\n|         present|   28|\n|        measures|   26|\n|representatives:|   24|\n|       provision|   24|\n|         indians|   23|\n|         militia|   20|\n|       gentlemen|   19|\n|           ought|   19|\n|          object|   17|\n|         however|   16|\n|    satisfaction|   15|\n|   establishment|   15|\n|             due|   15|\n|         objects|   15|\n|          tribes|   14|\n+----------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 16, 2016 11:23:10 PM","dateStarted":"Mar 25, 2016 11:28:24 PM","dateFinished":"Mar 25, 2016 11:28:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3381"},{"text":"%pyspark\nprint (\"*** GWB-AL\")\ngwb_al = word_count_gwb_clean.subtractByKey(word_count_al_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"])\ngwb_al.show(10)\ngwb_al.registerTempTable(\"gwb_al\")","dateUpdated":"Mar 25, 2016 11:40:42 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458243952781_1799887584","id":"20160317-124552_2025601185","result":{"code":"SUCCESS","type":"TEXT","msg":"*** GWB-AL\n+----------+-----+\n|      word|count|\n+----------+-----+\n|terrorists|   83|\n|      iraq|   80|\n|   tonight|   76|\n|    terror|   63|\n|   weapons|   56|\n|     iraqi|   48|\n|      jobs|   36|\n|   workers|   36|\n|        al|   36|\n| terrorist|   36|\n+----------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 17, 2016 12:45:52 PM","dateStarted":"Mar 25, 2016 11:40:42 PM","dateFinished":"Mar 25, 2016 11:40:44 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3382"},{"text":"%sql\nSELECT * FROM gwb_al limit 15","dateUpdated":"Mar 25, 2016 11:41:21 PM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458974380856_647127573","id":"20160325-233940_1567392157","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\nterrorists\t83\niraq\t80\ntonight\t76\nterror\t63\nweapons\t56\niraqi\t48\njobs\t36\nworkers\t36\nal\t36\nterrorist\t36\nafghanistan\t35\nqaeda\t32\ngoal\t32\nnuclear\t32\nmillion\t31\n","comment":"","msgTable":[[{"key":"count","value":"terrorists"},{"key":"count","value":"83"}],[{"value":"iraq"},{"value":"80"}],[{"value":"tonight"},{"value":"76"}],[{"value":"terror"},{"value":"63"}],[{"value":"weapons"},{"value":"56"}],[{"value":"iraqi"},{"value":"48"}],[{"value":"jobs"},{"value":"36"}],[{"value":"workers"},{"value":"36"}],[{"value":"al"},{"value":"36"}],[{"value":"terrorist"},{"value":"36"}],[{"value":"afghanistan"},{"value":"35"}],[{"value":"qaeda"},{"value":"32"}],[{"value":"goal"},{"value":"32"}],[{"value":"nuclear"},{"value":"32"}],[{"value":"million"},{"value":"31"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["terrorists","83"],["iraq","80"],["tonight","76"],["terror","63"],["weapons","56"],["iraqi","48"],["jobs","36"],["workers","36"],["al","36"],["terrorist","36"],["afghanistan","35"],["qaeda","32"],["goal","32"],["nuclear","32"],["million","31"]]},"dateCreated":"Mar 25, 2016 11:39:40 PM","dateStarted":"Mar 25, 2016 11:40:02 PM","dateFinished":"Mar 25, 2016 11:40:03 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3383"},{"text":"%md\n###Now it is easy to see Obama vs. FDR or WJC vs. AL ...","dateUpdated":"Mar 16, 2016 11:24:54 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458195827380_1118733935","id":"20160316-232347_1045182361","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Now it is easy to see Obama vs. FDR or WJC vs. AL &hellip;</h3>\n"},"dateCreated":"Mar 16, 2016 11:23:47 PM","dateStarted":"Mar 16, 2016 11:24:54 PM","dateFinished":"Mar 16, 2016 11:24:54 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3384"},{"text":"%pyspark\nprint (\"*** FDR-BO\")\nword_count_fdr_clean.subtractByKey(word_count_bo_clean).\\\nsortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:31:39 PM","config":{"colWidth":6,"graph":{"mode":"table","height":362,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458195894173_277196145","id":"20160316-232454_1822699321","result":{"code":"SUCCESS","type":"TEXT","msg":"*** FDR-BO\n+------------+-----+\n|        word|count|\n+------------+-----+\n|     present|   39|\n|    japanese|   36|\n|   therefore|   31|\n|   essential|   31|\n|       enemy|   24|\n|        1942|   22|\n|     methods|   21|\n|    adequate|   21|\n|  principles|   20|\n|     peoples|   20|\n|        1933|   19|\n|     however|   19|\n|  objectives|   19|\n| agriculture|   18|\n|civilization|   18|\n+------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 16, 2016 11:24:54 PM","dateStarted":"Mar 25, 2016 11:29:52 PM","dateFinished":"Mar 25, 2016 11:29:53 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3385"},{"text":"%pyspark\nprint (\"*** BO-FDR\")\nword_count_bo_clean.subtractByKey(word_count_fdr_clean).\\\nsortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:31:39 PM","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458195923145_-158723835","id":"20160316-232523_1108045170","result":{"code":"SUCCESS","type":"TEXT","msg":"*** BO-FDR\n+-----------+-----+\n|       word|count|\n+-----------+-----+\n|     energy|   87|\n|    tonight|   84|\n| businesses|   69|\n|    college|   40|\n|    schools|   36|\n|   students|   27|\n|        oil|   26|\n|       kids|   25|\n|republicans|   25|\n| innovation|   24|\n|        gas|   23|\n|  democrats|   23|\n|   research|   22|\n|    nuclear|   21|\n| technology|   20|\n+-----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 16, 2016 11:25:23 PM","dateStarted":"Mar 25, 2016 11:30:30 PM","dateFinished":"Mar 25, 2016 11:30:31 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3386"},{"text":"%pyspark\nprint (\"*** BO-WJC\")\nword_count_bo_clean.subtractByKey(word_count_wjc_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:36:19 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458195950554_-327597954","id":"20160316-232550_1982414058","result":{"code":"SUCCESS","type":"TEXT","msg":"*** BO-WJC\n+--------------+-----+\n|          word|count|\n+--------------+-----+\n|           oil|   26|\n| manufacturing|   19|\n|   afghanistan|   18|\n|            al|   15|\n|        afghan|   15|\n|          iran|   12|\n|         solar|   12|\n|         qaeda|   12|\n|          code|   11|\n|    rebuilding|   10|\n|         worse|   10|\n|infrastructure|   10|\n|         biden|    9|\n|        breaks|    9|\n|    high-speed|    8|\n+--------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 16, 2016 11:25:50 PM","dateStarted":"Mar 25, 2016 11:36:19 PM","dateFinished":"Mar 25, 2016 11:36:20 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3387"},{"text":"%pyspark\nprint (\"*** BO-GWB\")\nword_count_bo_clean.subtractByKey(word_count_gwb_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:35:54 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458195977942_-896226180","id":"20160316-232617_1319097904","result":{"code":"SUCCESS","type":"TEXT","msg":"*** BO-GWB\n+------------+-----+\n|        word|count|\n+------------+-----+\n|       banks|   22|\n|    industry|   20|\n|    trillion|   17|\n|middle-class|   13|\n|        wage|   12|\n|       class|   12|\n|       forge|   11|\n|         lay|   11|\n|     lending|   11|\n|        walk|   11|\n|       helps|   10|\n|     restore|   10|\n|     minimum|   10|\n|   high-tech|    9|\n|       biden|    9|\n+------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 16, 2016 11:26:17 PM","dateStarted":"Mar 25, 2016 11:35:54 PM","dateFinished":"Mar 25, 2016 11:35:55 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3388"},{"text":"%pyspark\nprint (\"*** BO-AL\")\nword_count_bo_clean.subtractByKey(word_count_al_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:35:26 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458196058473_344343836","id":"20160316-232738_1301451995","result":{"code":"SUCCESS","type":"TEXT","msg":"*** BO-AL\n+----------+-----+\n|      word|count|\n+----------+-----+\n|      jobs|  148|\n|   tonight|   84|\n|businesses|   69|\n|  families|   56|\n|       job|   51|\n|   deficit|   48|\n|   college|   40|\n|     today|   40|\n|     can't|   39|\n|   schools|   36|\n|   million|   36|\n|   workers|   35|\n|     clean|   35|\n|      hard|   32|\n|    budget|   30|\n+----------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 16, 2016 11:27:38 PM","dateStarted":"Mar 25, 2016 11:35:26 PM","dateFinished":"Mar 25, 2016 11:35:27 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3389"},{"text":"%pyspark\nprint (\"*** WJC-AL\")\nword_count_wjc_clean.subtractByKey(word_count_al_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:34:53 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458196081254_-1602070201","id":"20160316-232801_2108260949","result":{"code":"SUCCESS","type":"TEXT","msg":"*** WJC-AL\n+---------+-----+\n|     word|count|\n+---------+-----+\n|  tonight|   98|\n| families|   82|\n|   budget|   77|\n|challenge|   76|\n|  parents|   70|\n|  schools|   66|\n|     jobs|   66|\n|    child|   65|\n|  million|   64|\n|    today|   60|\n|    crime|   60|\n|     21st|   58|\n|  college|   54|\n|    thank|   47|\n|     bill|   47|\n+---------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 16, 2016 11:28:01 PM","dateStarted":"Mar 25, 2016 11:34:53 PM","dateFinished":"Mar 25, 2016 11:34:54 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3390"},{"text":"%pyspark\nprint (\"*** AL-BO\")\nword_count_al_clean.subtractByKey(word_count_bo_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:33:33 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458243983839_-2025839296","id":"20160317-124623_780330552","result":{"code":"SUCCESS","type":"TEXT","msg":"*** AL-BO\n+-------------+-----+\n|         word|count|\n+-------------+-----+\n|      persons|   30|\n|        naval|   27|\n|      present|   27|\n| emancipation|   25|\n|consideration|   22|\n|     receipts|   22|\n|      however|   21|\n|     measures|   20|\n|      slavery|   19|\n| proclamation|   17|\n|      vessels|   17|\n|       indian|   17|\n|     believed|   16|\n|       powers|   16|\n|       actual|   16|\n+-------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 17, 2016 12:46:23 PM","dateStarted":"Mar 25, 2016 11:33:34 PM","dateFinished":"Mar 25, 2016 11:33:35 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3391"},{"text":"%pyspark\nprint (\"*** AL-WJC\")\nword_count_al_clean.subtractByKey(word_count_wjc_clean).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(15)","dateUpdated":"Mar 25, 2016 11:32:40 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458244040998_531494698","id":"20160317-124720_1058609053","result":{"code":"SUCCESS","type":"TEXT","msg":"*** AL-WJC\n+-------------+-----+\n|         word|count|\n+-------------+-----+\n|      persons|   30|\n|         navy|   28|\n|    condition|   28|\n|        naval|   27|\n| emancipation|   25|\n|         thus|   23|\n|consideration|   22|\n|     receipts|   22|\n|       claims|   20|\n|     interior|   18|\n|      vessels|   17|\n| proclamation|   17|\n|       powers|   16|\n|     believed|   16|\n|       actual|   16|\n+-------------+-----+\nonly showing top 15 rows\n\n"},"dateCreated":"Mar 17, 2016 12:47:20 PM","dateStarted":"Mar 25, 2016 11:32:40 PM","dateFinished":"Mar 25, 2016 11:32:41 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3392"},{"text":"%md\n## That is All Folks !","dateUpdated":"Mar 17, 2016 12:48:11 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458244071606_-22112997","id":"20160317-124751_166142265","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>That is All Folks !</h2>\n"},"dateCreated":"Mar 17, 2016 12:47:51 PM","dateStarted":"Mar 17, 2016 12:48:11 PM","dateFinished":"Mar 17, 2016 12:48:11 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3393"},{"text":"%md\n## Oh, wait - One More/Last Thing\n### The debates !!!","dateUpdated":"Mar 25, 2016 11:43:59 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458244091388_-1566864506","id":"20160317-124811_12031663","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Oh, wait - One More/Last Thing</h2>\n<h3>The debates !!!</h3>\n"},"dateCreated":"Mar 17, 2016 12:48:11 PM","dateStarted":"Mar 25, 2016 11:43:59 PM","dateFinished":"Mar 25, 2016 11:43:59 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3394"},{"text":"%pyspark\nlines = sc.textFile(\"data/sotu/debates/RepublicanDebate-2016.txt\")\nrd = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.'), 1)).\\\n    reduceByKey(add)\nprint rd.count()","dateUpdated":"Mar 25, 2016 11:44:50 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458885048448_-1011136906","id":"20160324-225048_1709119714","result":{"code":"SUCCESS","type":"TEXT","msg":"11783\n"},"dateCreated":"Mar 24, 2016 10:50:48 PM","dateStarted":"Mar 25, 2016 11:44:50 PM","dateFinished":"Mar 25, 2016 11:44:51 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3395"},{"text":"%pyspark\nrd_1 = rd.sortBy(lambda x: x[1],ascending=False)\nrd_1.toDF([\"word\",\"count\"]).show(5)","dateUpdated":"Mar 25, 2016 11:45:48 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458885231768_-2134544042","id":"20160324-225351_549157612","result":{"code":"SUCCESS","type":"TEXT","msg":"+----+-----+\n|word|count|\n+----+-----+\n| the|12436|\n|    | 9397|\n|  to| 9311|\n| and| 7942|\n|  of| 5535|\n+----+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 24, 2016 10:53:51 PM","dateStarted":"Mar 25, 2016 11:45:48 PM","dateFinished":"Mar 25, 2016 11:45:49 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3396"},{"text":"%pyspark\nrd_clean = rd.filter(lambda x: x[0] not in common_words)\nprint rd_clean.count()\n#\nrd_1 = rd_clean.sortBy(lambda x: x[1],ascending=False)\nrd_1.toDF([\"word\",\"count\"]).show(5)","dateUpdated":"Mar 25, 2016 11:46:08 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"(u'\\u2014', 1881)","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"(u'\\u2014', 1881)","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458885361829_1571524285","id":"20160324-225601_1945347007","result":{"code":"SUCCESS","type":"TEXT","msg":"11670\n+----------+-----+\n|      word|count|\n+----------+-----+\n|         | 1881|\n|    people| 1585|\n|     going| 1228|\n|[applause]|  918|\n|        me|  852|\n+----------+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 24, 2016 10:56:01 PM","dateStarted":"Mar 25, 2016 11:46:08 PM","dateFinished":"Mar 25, 2016 11:46:09 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3397"},{"text":"%pyspark\nlines = sc.textFile(\"data/sotu/debates/DemocraticDebate-2016.txt\")\ndd = lines.flatMap(lambda x: x.split(' ')).\\\n    map(lambda x: (x.lower().rstrip().lstrip().rstrip(',').rstrip('.'), 1)).\\\n    reduceByKey(add)\nprint dd.count()\ndd_clean = dd.filter(lambda x: x[0] not in common_words)\nprint dd_clean.count()\n#\ndd_1 = dd_clean.sortBy(lambda x: x[1],ascending=False)\ndd_1.toDF([\"word\",\"count\"]).show(5)","dateUpdated":"Mar 25, 2016 11:46:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"(u'people', 787)","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"(u'people', 787)","index":0,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458885483139_1466841936","id":"20160324-225803_1213105108","result":{"code":"SUCCESS","type":"TEXT","msg":"8048\n7935\n+----------+-----+\n|      word|count|\n+----------+-----+\n|    people|  787|\n|     think|  609|\n|   senator|  595|\n| secretary|  571|\n|[applause]|  520|\n+----------+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 24, 2016 10:58:03 PM","dateStarted":"Mar 25, 2016 11:46:57 PM","dateFinished":"Mar 25, 2016 11:46:58 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3398"},{"text":"%pyspark\nprint (\"*** RD-DD\")\nrd_clean.subtractByKey(dd_clean).sortBy(lambda x: x[1],\n    ascending= False).toDF([\"word\",\"count\"]).show(10)","dateUpdated":"Mar 25, 2016 11:49:07 PM","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458885645846_-1557270739","id":"20160324-230045_196010384","result":{"code":"SUCCESS","type":"TEXT","msg":"*** RD-DD\n+--------+-----+\n|    word|count|\n+--------+-----+\n|  trump:|  787|\n|  rubio:|  429|\n|   cruz:|  384|\n| tapper:|  290|\n|   bush:|  279|\n| kasich:|  234|\n|blitzer:|  209|\n|  kelly:|  206|\n|  kasich|  165|\n|  carson|  154|\n+--------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 24, 2016 11:00:45 PM","dateStarted":"Mar 25, 2016 11:49:07 PM","dateFinished":"Mar 25, 2016 11:49:09 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3399"},{"text":"%pyspark\nprint (\"*** DD-RD\")\ndd_clean.subtractByKey(rd_clean).sortBy(lambda x: x[1],\n    ascending= False).toDF([\"word\",\"count\"]).show(10)","dateUpdated":"Mar 25, 2016 11:49:14 PM","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458886024862_-1322617714","id":"20160324-230704_463148005","result":{"code":"SUCCESS","type":"TEXT","msg":"*** DD-RD\n+---------+-----+\n|     word|count|\n+---------+-----+\n| sanders:|  502|\n| clinton:|  452|\n|  cooper:|  279|\n|o'malley:|  163|\n| o'malley|   87|\n|    holt:|   87|\n|    todd:|   66|\n|   ramos:|   56|\n|  maddow:|   43|\n|mitchell:|   41|\n+---------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 24, 2016 11:07:04 PM","dateStarted":"Mar 25, 2016 11:49:14 PM","dateFinished":"Mar 25, 2016 11:49:15 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3400"},{"text":"%pyspark\ncommon2 = ['sanders:','clinton:','clinton','sanders','cooper:',\"o'malley:\",\"o'malley\",'holt:','todd:','ramos:','maddow:',\n    'mitchell:','salinas:','webb:','woodruff:','[through','lemon:','ifill:','webb','andrea','chafee:','trump:','trump','rubio:','cruz:',\n    'tapper:','bush:','kasich:','blitzer:','kelly:','kasich','carson','baier:','wallace:','carson:','paul:','christie:','fiorina:',\n    'bartiromo:','christie','hewitt:','cavuto:','jeb','[applause]','me','your','my','\\u2014','said','out','very','huckabee:','','quintanilla:',\n    'harwood:','jake','ben','hugh','baker:','huckabee','walker:','trump?','rand','rubio?','megyn','cruz?','tumulty:','sanders?','chafee',\n    'translator]:',\"lester\",\"martin\"]","dateUpdated":"Mar 26, 2016 12:17:31 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458886094630_2018480438","id":"20160324-230814_1301902981","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Mar 24, 2016 11:08:14 PM","dateStarted":"Mar 26, 2016 12:17:31 AM","dateFinished":"Mar 26, 2016 12:17:32 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3401"},{"text":"%pyspark\nrd_clean = rd_clean.filter(lambda x: x[0] not in common2)\nprint rd_clean.count()\n#\nrd_1 = rd_clean.sortBy(lambda x: x[1],ascending=False)\nrd_1.toDF([\"word\",\"count\"]).show(5)","dateUpdated":"Mar 26, 2016 12:17:36 AM","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"(u'\\u2014', 1881)","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"(u'\\u2014', 1881)","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458887649447_1239181669","id":"20160324-233409_1651549353","result":{"code":"SUCCESS","type":"TEXT","msg":"11625\n+-------+-----+\n|   word|count|\n+-------+-----+\n|      | 1881|\n| people| 1585|\n|  going| 1228|\n|country|  813|\n|  think|  808|\n+-------+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 24, 2016 11:34:09 PM","dateStarted":"Mar 26, 2016 12:17:36 AM","dateFinished":"Mar 26, 2016 12:17:43 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3402"},{"text":"%pyspark\ndd_clean = dd_clean.filter(lambda x: x[0] not in common2)\nprint dd_clean.count()\n#\ndd_1 = dd_clean.sortBy(lambda x: x[1],ascending=False)\ndd_1.toDF([\"word\",\"count\"]).show(5)","dateUpdated":"Mar 26, 2016 12:17:50 AM","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458888032654_1247183654","id":"20160324-234032_1454546225","result":{"code":"SUCCESS","type":"TEXT","msg":"7900\n+---------+-----+\n|     word|count|\n+---------+-----+\n|   people|  787|\n|    think|  609|\n|  senator|  595|\n|secretary|  571|\n|    going|  509|\n+---------+-----+\nonly showing top 5 rows\n\n"},"dateCreated":"Mar 24, 2016 11:40:32 PM","dateStarted":"Mar 26, 2016 12:17:50 AM","dateFinished":"Mar 26, 2016 12:17:56 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3403"},{"text":"%pyspark\nprint (\"*** RD-DD\")\nrd_1.subtractByKey(dd_1).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(10)","dateUpdated":"Mar 26, 2016 12:18:01 AM","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458888487271_-2143547105","id":"20160324-234807_744270750","result":{"code":"SUCCESS","type":"TEXT","msg":"*** RD-DD\n+----------+-----+\n|      word|count|\n+----------+-----+\n|   amnesty|   67|\n|    quick:|   64|\n|     [bell|   58|\n|   islamic|   56|\n|    rings]|   39|\n|       fed|   37|\n|retirement|   32|\n|       irs|   29|\n|       fox|   28|\n|        $2|   27|\n+----------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 24, 2016 11:48:07 PM","dateStarted":"Mar 26, 2016 12:18:01 AM","dateFinished":"Mar 26, 2016 12:18:02 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3404"},{"text":"%pyspark\nprint (\"*** DD-RD\")\ndd_1.subtractByKey(rd_1).sortBy(lambda x: x[1],ascending=False).toDF([\"word\",\"count\"]).show(10)","dateUpdated":"Mar 26, 2016 12:21:45 AM","config":{"colWidth":6,"graph":{"mode":"table","height":275,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458888601211_1721791942","id":"20160324-235001_845074127","result":{"code":"SUCCESS","type":"TEXT","msg":"*** DD-RD\n+--------------+-----+\n|          word|count|\n+--------------+-----+\n|        fossil|   23|\n|glass-steagall|   21|\n|      immunity|   19|\n|        racism|   18|\n|     crumbling|   17|\n|        rigged|   15|\n|     debt-free|   15|\n|          koch|   14|\n|   (inaudible)|   13|\n|       cordes:|   13|\n+--------------+-----+\nonly showing top 10 rows\n\n"},"dateCreated":"Mar 24, 2016 11:50:01 PM","dateStarted":"Mar 26, 2016 12:21:45 AM","dateFinished":"Mar 26, 2016 12:21:46 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3405"},{"text":"%md\n### TF-IDF as Feature Extraction","dateUpdated":"Mar 25, 2016 5:33:45 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458888739453_2146770911","id":"20160324-235219_1330974942","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>TF-IDF as Feature Extraction</h3>\n"},"dateCreated":"Mar 24, 2016 11:52:19 PM","dateStarted":"Mar 25, 2016 5:33:45 PM","dateFinished":"Mar 25, 2016 5:33:45 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3406"},{"text":"%pyspark\ndocuments = sc.textFile(\"data/sotu/debates/\").map(lambda line: line.split(\" \"))\nprint documents.count()\nprint documents.take(3)","dateUpdated":"Mar 25, 2016 12:31:56 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458889650435_-1350344826","id":"20160325-000730_1450539639","result":{"code":"SUCCESS","type":"TEXT","msg":"26067\n[[u'Democratic', u'Candidates', u'Debate', u'in', u'Las', u'Vegas,', u'Nevada'], [u'October', u'13,', u'2015'], [u'']]\n"},"dateCreated":"Mar 25, 2016 12:07:30 AM","dateStarted":"Mar 25, 2016 12:31:56 AM","dateFinished":"Mar 25, 2016 12:31:57 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3407"},{"text":"%pyspark\nfrom pyspark.mllib.feature import HashingTF,IDF\nhashingTF = HashingTF()\ntf = hashingTF.transform(documents)\nprint tf.take(10)\n#\ntf.cache()\nidf = IDF().fit(tf)\ntfidf = idf.transform(tf)\nprint tfidf.take(10)","dateUpdated":"Mar 25, 2016 12:14:24 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458889673422_1015906882","id":"20160325-000753_1284129256","result":{"code":"SUCCESS","type":"TEXT","msg":"[SparseVector(1048576, {50583: 1.0, 157821: 1.0, 203611: 1.0, 244091: 1.0, 648596: 1.0, 896959: 1.0, 980744: 1.0}), SparseVector(1048576, {334392: 1.0, 911683: 1.0, 1014287: 1.0}), SparseVector(1048576, {0: 1.0}), SparseVector(1048576, {972429: 1.0}), SparseVector(1048576, {163308: 1.0, 686269: 1.0, 709582: 1.0, 744258: 1.0, 978010: 1.0}), SparseVector(1048576, {63634: 1.0, 304434: 1.0, 323305: 1.0, 648543: 1.0, 657242: 1.0, 686269: 1.0}), SparseVector(1048576, {141783: 1.0, 182622: 1.0, 418582: 1.0, 686269: 1.0, 709582: 1.0}), SparseVector(1048576, {639967: 1.0, 944417: 1.0, 1006297: 1.0, 1012455: 1.0}), SparseVector(1048576, {133344: 1.0, 399371: 1.0, 577702: 1.0, 686269: 1.0, 1006297: 1.0}), SparseVector(1048576, {1007897: 1.0})]\n[SparseVector(1048576, {50583: 1.8225, 157821: 6.8363, 203611: 5.2268, 244091: 8.2226, 648596: 6.9104, 896959: 7.5294, 980744: 8.3767}), SparseVector(1048576, {334392: 7.8659, 911683: 8.559, 1014287: 8.7822}), SparseVector(1048576, {0: 0.7008}), SparseVector(1048576, {972429: 3.7732}), SparseVector(1048576, {163308: 9.0699, 686269: 6.4796, 709582: 3.7883, 744258: 8.7822, 978010: 9.4753}), SparseVector(1048576, {63634: 6.1982, 304434: 4.6001, 323305: 1.6493, 648543: 4.1282, 657242: 7.9712, 686269: 6.4796}), SparseVector(1048576, {141783: 7.6836, 182622: 7.033, 418582: 8.559, 686269: 6.4796, 709582: 3.7883}), SparseVector(1048576, {639967: 6.1982, 944417: 5.0996, 1006297: 3.3109, 1012455: 7.9712}), SparseVector(1048576, {133344: 7.9712, 399371: 7.6035, 577702: 9.4753, 686269: 6.4796, 1006297: 3.3109}), SparseVector(1048576, {1007897: 7.224})]\n"},"dateCreated":"Mar 25, 2016 12:07:53 AM","dateStarted":"Mar 25, 2016 12:14:24 AM","dateFinished":"Mar 25, 2016 12:14:26 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3408"},{"text":"%md\n### We can see the features, but not easy to go back to the word vector from the hashes\n### TF-IDF is useful as a part of the pipeline towards ML algorithms like Classification\n### _That is why HashingTF and IDF are part of pyspark.mllib.feature_","dateUpdated":"Mar 25, 2016 5:37:11 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458889728370_-1225362730","id":"20160325-000848_881479606","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>We can see the features, but not easy to go back to the word vector from the hashes</h3>\n<h3>TF-IDF is useful as a part of the pipeline towards ML algorithms like Classification</h3>\n<h3><em>That is why HashingTF and IDF are part of pyspark.mllib.feature</em></h3>\n"},"dateCreated":"Mar 25, 2016 12:08:48 AM","dateStarted":"Mar 25, 2016 5:37:11 PM","dateFinished":"Mar 25, 2016 5:37:11 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3409"},{"text":"%md\n### ML API to Rescue","dateUpdated":"Mar 25, 2016 6:45:44 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458952476255_-514425617","id":"20160325-173436_1153754343","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>ML API to Rescue</h3>\n"},"dateCreated":"Mar 25, 2016 5:34:36 PM","dateStarted":"Mar 25, 2016 6:45:44 PM","dateFinished":"Mar 25, 2016 6:45:44 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3410"},{"text":"%pyspark\nfrom pyspark.ml.feature import HashingTF, IDF, Tokenizer\n\nsentenceData = sqlContext.createDataFrame([\n    (0, \"Hi I heard about Spark\"),\n    (0, \"I wish Java could use case classes\"),\n    (1, \"Logistic regression models are neat\")\n], [\"label\", \"sentence\"])\ntokenizer = Tokenizer(inputCol=\"sentence\", outputCol=\"words\")\nwordsData = tokenizer.transform(sentenceData)\nhashingTF = HashingTF(inputCol=\"words\", outputCol=\"rawFeatures\", numFeatures=20)\nfeaturizedData = hashingTF.transform(wordsData)\nidf = IDF(inputCol=\"rawFeatures\", outputCol=\"features\")\nidfModel = idf.fit(featurizedData)\nrescaledData = idfModel.transform(featurizedData)\nfor features_label in rescaledData.select(\"features\", \"label\").take(3):\n    print(features_label)","dateUpdated":"Mar 25, 2016 6:48:09 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458956744023_1526196585","id":"20160325-184544_1694112377","result":{"code":"SUCCESS","type":"TEXT","msg":"Row(features=SparseVector(20, {5: 0.0, 6: 0.6931, 9: 1.3863}), label=0)\nRow(features=SparseVector(20, {3: 1.3863, 5: 0.0, 12: 0.2877, 14: 0.2877, 18: 0.2877}), label=0)\nRow(features=SparseVector(20, {5: 0.0, 12: 0.5754, 14: 0.2877, 18: 0.2877}), label=1)\n"},"dateCreated":"Mar 25, 2016 6:45:44 PM","dateStarted":"Mar 25, 2016 6:48:09 PM","dateFinished":"Mar 25, 2016 6:48:11 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3411"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458958043474_-1218945255","id":"20160325-190723_1548018439","dateCreated":"Mar 25, 2016 7:07:23 PM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3415"}],"name":"03-Text Analytics","id":"2BFN31NA7","angularObjects":{"2BFJWMQ9H":[],"2BE8A7YV6":[],"2BG1VHWRJ":[],"2BEKJ6EK5":[],"2BF216UPS":[],"2BEZ62K9N":[],"2BD587MW7":[],"2BE7MJQ3Z":[],"2BFKH5WZX":[],"2BDJW333S":[],"2BEB288BJ":[],"2BFAUCSV2":[],"2BFK98EU6":[],"2BCTH3CWC":[]},"config":{"looknfeel":"default"},"info":{}}